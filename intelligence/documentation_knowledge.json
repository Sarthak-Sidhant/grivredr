{
  "total_documents": 12,
  "total_code_examples": 180,
  "documents": [
    {
      "title": "Grivredr - AI-Powered Grievance Automation System",
      "file_path": "README.md",
      "key_concepts": [
        "Grivredr - AI-Powered Grievance Automation System",
        "\ud83d\ude80 Features",
        "\ud83c\udfd7\ufe0f Architecture",
        "\ud83d\udcc1 Project Structure",
        "\ud83d\udee0\ufe0f Installation",
        "1. Install Python Dependencies",
        "2. Install Playwright Browsers",
        "3. Configure API Key",
        "\ud83c\udfaf Quick Start - Ranchi Municipality",
        "Step 1: Learn Ranchi Websites & Generate Scrapers",
        "Step 2: Test Generated Scrapers",
        "Step 3: Start FastAPI Backend",
        "\ud83d\udce1 API Endpoints",
        "1. Learn New Municipality",
        "2. Submit Grievance",
        "3. Check Status",
        "4. List Available Scrapers",
        "5. List Municipalities",
        "\ud83d\udd27 How It Works",
        "Phase 1: Learning (One-time per website)",
        "Phase 2: Execution (Repeated use, fast & cheap)",
        "\ud83d\udca1 Usage Examples",
        "Python",
        "cURL",
        "\ud83c\udfa8 AI Models Used",
        "\ud83d\udd12 Security Considerations",
        "\ud83d\udea7 Limitations & Future Work",
        "\ud83d\udcdd Adding New Municipalities",
        "Option 1: Via API",
        "Option 2: Via Python Script",
        "\ud83d\udc1b Debugging",
        "View Learning Results",
        "Check Scraper Code",
        "View Execution Logs",
        "Screenshots",
        "\ud83d\udcc4 License",
        "\ud83e\udd1d Contributing",
        "\u2696\ufe0f Legal"
      ],
      "code_examples": [
        {
          "language": "text",
          "code": "\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  1. Website Learning (AI-Powered, One-time)             \u2502\n\u2502     - Playwright browser automation                     \u2502\n\u2502     - Claude Vision analysis                            \u2502\n\u2502     - Form structure extraction                         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                          \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  2. Scraper Generation (AI-Powered, One-time)           \u2502\n\u2502     - Claude generates Python code                      \u2502\n\u2502     - Saves reusable scraper scripts                    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                          \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  3. Execution (Fast, No AI needed)                      \u2502\n\u2502     - Runs generated scrapers                           \u2502\n\u2502     - Submits real grievances                           \u2502\n\u2502     - Returns tracking IDs                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518",
          "description": "- **Multi-Municipality**: Support for multiple municipalities and websites",
          "context": "ation\n- **Multi-Municipality**: Support for multiple municipalities and websites\n\n## \ud83c\udfd7\ufe0f Architecture"
        },
        {
          "language": "text",
          "code": "grivredr/\n\u251c\u2500\u2500 config/\n\u2502   \u251c\u2500\u2500 ai_client.py          # Claude API client\n\u2502   \u2514\u2500\u2500 municipalities.json   # Municipality configurations\n\u251c\u2500\u2500 website_learner/\n\u2502   \u251c\u2500\u2500 learner.py           # AI website exploration\n\u2502   \u2514\u2500\u2500 screenshots/         # Website screenshots\n\u251c\u2500\u2500 scraper_generator/\n\u2502   \u2514\u2500\u2500 generator.py         # Scraper code generator\n\u251c\u2500\u2500 generated_scrapers/\n\u2502   \u2514\u2500\u2500 ranchi/              # Generated scrapers by municipality\n\u251c\u2500\u2500 executor/\n\u2502   \u251c\u2500\u2500 runner.py            # Scraper execution engine\n\u2502   \u2514\u2500\u2500 results/             # Submission results\n\u251c\u2500\u2500 main.py                  # FastAPI backend\n\u251c\u2500\u2500 learn_ranchi.py          # Quick start script\n\u251c\u2500\u2500 test_scrapers.py         # Testing script\n\u2514\u2500\u2500 requirements.txt",
          "description": "```",
          "context": "           \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n```\n\n## \ud83d\udcc1 Project Structure"
        },
        {
          "language": "bash",
          "code": "pip install -r requirements.txt",
          "description": "```",
          "context": "   # Testing script\n\u2514\u2500\u2500 requirements.txt\n```\n\n## \ud83d\udee0\ufe0f Installation\n\n### 1. Install Python Dependencies"
        },
        {
          "language": "bash",
          "code": "playwright install chromium",
          "description": "```",
          "context": "Python Dependencies\n\n```bash\npip install -r requirements.txt\n```\n\n### 2. Install Playwright Browsers"
        },
        {
          "language": "env",
          "code": "api_key=sk-mega-1100253245ae4c908dec293b5fc3b8ee95728a7e19269694d5a383ed2ca4b984",
          "description": "Your `.env` file is already configured:",
          "context": "h\nplaywright install chromium\n```\n\n### 3. Configure API Key\n\nYour `.env` file is already configured:"
        },
        {
          "language": "bash",
          "code": "python learn_ranchi.py",
          "description": "```",
          "context": "4\n```\n\n## \ud83c\udfaf Quick Start - Ranchi Municipality\n\n### Step 1: Learn Ranchi Websites & Generate Scrapers"
        },
        {
          "language": "bash",
          "code": "python test_scrapers.py",
          "description": "3. https://jharkhandegovernance.com/grievance/main",
          "context": "spx?m=Online\n3. https://jharkhandegovernance.com/grievance/main\n\n### Step 2: Test Generated Scrapers"
        },
        {
          "language": "bash",
          "code": "python main.py",
          "description": "```",
          "context": "p 2: Test Generated Scrapers\n\n```bash\npython test_scrapers.py\n```\n\n### Step 3: Start FastAPI Backend"
        },
        {
          "language": "json",
          "code": "{\n  \"municipality_name\": \"ranchi\",\n  \"websites\": [\n    {\n      \"url\": \"https://smartranchi.in/Portal/View/ComplaintRegistration.aspx?m=Online\",\n      \"type\": \"complaint_form\",\n      \"description\": \"Smart Ranchi complaint registration\"\n    }\n  ],\n  \"headless\": true,\n  \"generate_scrapers\": true\n}",
          "description": "**POST** `/api/learn`",
          "context": " at: http://localhost:8000\n\n## \ud83d\udce1 API Endpoints\n\n### 1. Learn New Municipality\n\n**POST** `/api/learn`"
        },
        {
          "language": "json",
          "code": "{\n  \"municipality\": \"ranchi\",\n  \"website_type\": \"complaint_form\",\n  \"grievance_data\": {\n    \"name\": \"John Doe\",\n    \"phone\": \"9876543210\",\n    \"email\": \"john@example.com\",\n    \"complaint\": \"Street light not working\",\n    \"category\": \"Electricity\",\n    \"address\": \"Sector 5, Ranchi\"\n  }\n}",
          "description": "**POST** `/api/submit`",
          "context": "\"headless\": true,\n  \"generate_scrapers\": true\n}\n```\n\n### 2. Submit Grievance\n\n**POST** `/api/submit`"
        },
        {
          "language": "json",
          "code": "{\n  \"municipality\": \"ranchi\",\n  \"tracking_id\": \"RMC12345\"\n}",
          "description": "**POST** `/api/status`",
          "context": "ectricity\",\n    \"address\": \"Sector 5, Ranchi\"\n  }\n}\n```\n\n### 3. Check Status\n\n**POST** `/api/status`"
        },
        {
          "language": "python",
          "code": "import asyncio\nfrom executor.runner import ScraperExecutor\n\nasync def submit():\n    executor = ScraperExecutor()\n\n    result = await executor.execute_scraper(\n        municipality_name=\"ranchi\",\n        website_type=\"complaint_form\",\n        grievance_data={\n            \"name\": \"John Doe\",\n            \"complaint\": \"Issue description\"\n        }\n    )\n\n    print(f\"Tracking ID: {result['tracking_id']}\")\n\nasyncio.run(submit())",
          "description": "- Screenshots for debugging",
          "context": "cess/failure status\n   - Tracking ID\n   - Screenshots for debugging\n\n## \ud83d\udca1 Usage Examples\n\n### Python"
        },
        {
          "language": "bash",
          "code": "curl -X POST http://localhost:8000/api/submit \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"municipality\": \"ranchi\",\n    \"website_type\": \"complaint_form\",\n    \"grievance_data\": {\n      \"name\": \"John Doe\",\n      \"complaint\": \"Street light issue\"\n    }\n  }'",
          "description": "```",
          "context": "    }\n    )\n\n    print(f\"Tracking ID: {result['tracking_id']}\")\n\nasyncio.run(submit())\n```\n\n### cURL"
        },
        {
          "language": "bash",
          "code": "curl -X POST http://localhost:8000/api/learn \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"municipality_name\": \"new_city\",\n    \"websites\": [\n      {\n        \"url\": \"https://newcity.gov.in/complaints\",\n        \"type\": \"complaint_form\"\n      }\n    ]\n  }'",
          "description": "- Social media posting automation",
          "context": "integration\n- Social media posting automation\n\n## \ud83d\udcdd Adding New Municipalities\n\n### Option 1: Via API"
        },
        {
          "language": "python",
          "code": "import asyncio\nfrom website_learner.learner import WebsiteLearner\nfrom scraper_generator.generator import ScraperGenerator\n\nasync def add_new_city():\n    websites = [{\"url\": \"...\", \"type\": \"complaint_form\"}]\n\n    async with WebsiteLearner(headless=False) as learner:\n        results = await learner.learn_multiple_websites(\n            websites=websites,\n            municipality_name=\"new_city\"\n        )\n\n    generator = ScraperGenerator()\n    generator.generate_scrapers_for_municipality(results, \"new_city\")\n\nasyncio.run(add_new_city())",
          "description": "```",
          "context": "omplaints\",\n        \"type\": \"complaint_form\"\n      }\n    ]\n  }'\n```\n\n### Option 2: Via Python Script"
        },
        {
          "language": "bash",
          "code": "cat website_learner/results_ranchi.json",
          "description": "```",
          "context": "ity(results, \"new_city\")\n\nasyncio.run(add_new_city())\n```\n\n## \ud83d\udc1b Debugging\n\n### View Learning Results"
        },
        {
          "language": "bash",
          "code": "cat generated_scrapers/ranchi/ranchi_complaint_form_scraper.py",
          "description": "```",
          "context": "# View Learning Results\n\n```bash\ncat website_learner/results_ranchi.json\n```\n\n### Check Scraper Code"
        }
      ],
      "patterns": [],
      "best_practices": [],
      "architecture_notes": [
        "- **FastAPI Backend**: REST API for easy integration\n- **Multi-Municipality**: Support for multiple municipalities and websites",
        "\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                          \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  2. Scraper Generation (AI-Powered, One-time)           \u2502\n\u2502     - Claude generates Python code                      \u2502\n\u2502     - Saves reusable scraper scripts                    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                          \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  3. Execution (Fast, N"
      ]
    },
    {
      "title": "Grivredr - System Architecture",
      "file_path": "ARCHITECTURE.md",
      "key_concepts": [
        "Grivredr - System Architecture",
        "\ud83c\udfd7\ufe0f High-Level Architecture",
        "\ud83d\udd04 Data Flow",
        "Flow 1: Learning & Generation (One-time)",
        "Flow 2: Grievance Submission (Repeated, Fast)",
        "\ud83d\udce6 Module Breakdown",
        "1. config/ai_client.py",
        "2. website_learner/learner.py",
        "3. scraper_generator/generator.py",
        "4. executor/runner.py",
        "5. main.py",
        "\ud83d\uddc4\ufe0f Data Storage",
        "File System Structure",
        "municipalities.json Schema",
        "Execution Result Schema",
        "\ud83d\udd10 Security Architecture",
        "API Key Management",
        "Input Validation",
        "Browser Security",
        "Rate Limiting (Recommended)",
        "\u26a1 Performance Characteristics",
        "Learning Phase",
        "Execution Phase",
        "Scalability",
        "\ud83d\udd04 Error Handling & Resilience",
        "Retry Logic",
        "Self-Healing",
        "Failure Modes",
        "\ud83d\ude80 Deployment Options",
        "Option 1: Single Server",
        "Option 2: Docker",
        "Option 3: Kubernetes",
        "\ud83d\udcca Monitoring & Observability",
        "Metrics to Track",
        "Logging",
        "Health Checks",
        "\ud83d\udd2e Future Enhancements",
        "1. Auto-Healing Scrapers",
        "2. Scraper Versioning",
        "3. Multi-Model Support",
        "4. Browser Pool",
        "5. Database Integration"
      ],
      "code_examples": [
        {
          "language": "text",
          "code": "\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                        USER INTERFACES                          \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510       \u2502\n\u2502  \u2502   Web    \u2502  \u2502 WhatsApp \u2502  \u2502   API    \u2502  \u2502  Python  \u2502       \u2502\n\u2502  \u2502Interface \u2502  \u2502   Bot    \u2502  \u2502  Client  \u2502  \u2502  Script  \u2502       \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518       \u2502\n\u2502       \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                            \u2502\n                            \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                   FASTAPI REST API (main.py)                    \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510      \u2502\n\u2502  \u2502 /api/learn    \u2502  \u2502 /api/submit   \u2502  \u2502 /api/status   \u2502      \u2502\n\u2502  \u2502 /api/scrapers \u2502  \u2502 /api/batch    \u2502  \u2502 /api/munic.   \u2502      \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n           \u2502                  \u2502                  \u2502\n           \u25bc                  \u25bc                  \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Website Learner  \u2502  \u2502 Scraper Executor \u2502  \u2502 Status Checker   \u2502\n\u2502  (learner.py)    \u2502  \u2502  (runner.py)     \u2502  \u2502  (runner.py)     \u2502\n\u2502                  \u2502  \u2502                  \u2502  \u2502                  \u2502\n\u2502 \u2022 Playwright     \u2502  \u2502 \u2022 Load scraper   \u2502  \u2502 \u2022 Run status     \u2502\n\u2502 \u2022 Browser auto   \u2502  \u2502 \u2022 Execute        \u2502  \u2502   scraper        \u2502\n\u2502 \u2022 Screenshots    \u2502  \u2502 \u2022 Handle retry   \u2502  \u2502 \u2022 Parse status   \u2502\n\u2502 \u2022 HTML extract   \u2502  \u2502 \u2022 Save results   \u2502  \u2502                  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502                     \u2502\n         \u25bc                     \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510           \u2502\n\u2502  Claude Vision   \u2502           \u2502\n\u2502   AI Analysis    \u2502           \u2502\n\u2502  (ai_client.py)  \u2502           \u2502\n\u2502                  \u2502           \u2502\n\u2502 \u2022 Analyze form   \u2502           \u2502\n\u2502 \u2022 Identify fields\u2502           \u2502\n\u2502 \u2022 Return JSON    \u2502           \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518           \u2502\n         \u2502                     \u2502\n         \u25bc                     \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510           \u2502\n\u2502 Scraper Generator\u2502           \u2502\n\u2502  (generator.py)  \u2502           \u2502\n\u2502                  \u2502           \u2502\n\u2502 \u2022 Call Claude    \u2502           \u2502\n\u2502 \u2022 Generate code  \u2502           \u2502\n\u2502 \u2022 Save to file   \u2502           \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518           \u2502\n         \u2502                     \u2502\n         \u25bc                     \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              Generated Scrapers (Python Files)                \u2502\n\u2502  generated_scrapers/                                          \u2502\n\u2502    \u251c\u2500\u2500 ranchi/                                                \u2502\n\u2502    \u2502   \u251c\u2500\u2500 ranchi_complaint_form_scraper.py                   \u2502\n\u2502    \u2502   \u251c\u2500\u2500 ranchi_status_checker_scraper.py                   \u2502\n\u2502    \u2502   \u2514\u2500\u2500 __init__.py                                        \u2502\n\u2502    \u251c\u2500\u2500 patna/                                                 \u2502\n\u2502    \u2514\u2500\u2500 ...                                                    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502                     \u25b2\n         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n           (Executor loads and runs scrapers)",
          "description": "",
          "context": "# Grivredr - System Architecture\n\n## \ud83c\udfd7\ufe0f High-Level Architecture"
        },
        {
          "language": "text",
          "code": "Municipality URL\n       \u2502\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 WebsiteLearner   \u2502 \u2500\u2500\u25ba Open browser (Playwright)\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Navigate & Click \u2502 \u2500\u2500\u25ba Find grievance form\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Take Screenshot  \u2502 \u2500\u2500\u25ba Full page PNG + HTML\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Claude Vision    \u2502 \u2500\u2500\u25ba Analyze structure\n\u2502 (Sonnet 4.5)     \u2502     Return JSON\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u25bc\n{\n  \"form_fields\": [\n    {\"label\": \"Name\", \"selector\": \"#name\", ...},\n    {\"label\": \"Phone\", \"selector\": \"#phone\", ...}\n  ],\n  \"submit_button\": {\"selector\": \"#submit\"},\n  ...\n}\n       \u2502\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Claude Opus      \u2502 \u2500\u2500\u25ba Generate Python code\n\u2502 (Code Gen)       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u25bc\nclass RanchiScraper:\n    async def submit_grievance(self, data):\n        # AI-generated Playwright automation\n        ...\n        return {\"success\": True, \"tracking_id\": \"...\"}\n       \u2502\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Save to File     \u2502 \u2500\u2500\u25ba generated_scrapers/ranchi/...\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518",
          "description": "```",
          "context": "(Executor loads and runs scrapers)\n```\n\n## \ud83d\udd04 Data Flow\n\n### Flow 1: Learning & Generation (One-time)"
        },
        {
          "language": "text",
          "code": "User Grievance Data\n{\n  \"name\": \"John\",\n  \"complaint\": \"...\",\n  ...\n}\n       \u2502\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 FastAPI Endpoint \u2502 \u2500\u2500\u25ba /api/submit\n\u2502 (main.py)        \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 ScraperExecutor  \u2502 \u2500\u2500\u25ba Load generated scraper\n\u2502 (runner.py)      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Dynamic Import   \u2502 \u2500\u2500\u25ba Import RanchiScraper class\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Execute Scraper  \u2502 \u2500\u2500\u25ba scraper.submit_grievance(data)\n\u2502 (No AI calls!)   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Playwright       \u2502 \u2500\u2500\u25ba Open browser\n\u2502 Automation       \u2502     Fill form\n\u2502                  \u2502     Submit\n\u2502                  \u2502     Capture tracking ID\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u25bc\n{\n  \"success\": true,\n  \"tracking_id\": \"RMC123\",\n  \"screenshots\": [...],\n  \"execution_time\": 5.2\n}\n       \u2502\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Save Result      \u2502 \u2500\u2500\u25ba executor/results/ranchi_...json\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Return to User   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518",
          "description": "```",
          "context": "ated_scrapers/ranchi/...\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n```\n\n### Flow 2: Grievance Submission (Repeated, Fast)"
        },
        {
          "language": "text",
          "code": "grivredr/\n\u251c\u2500\u2500 config/\n\u2502   \u2514\u2500\u2500 municipalities.json          # Municipality configurations\n\u2502\n\u251c\u2500\u2500 website_learner/\n\u2502   \u251c\u2500\u2500 screenshots/                 # Learning screenshots\n\u2502   \u2502   \u251c\u2500\u2500 ranchi_main_portal.png\n\u2502   \u2502   \u2514\u2500\u2500 ranchi_complaint_form.png\n\u2502   \u2514\u2500\u2500 results_ranchi.json          # Raw learning results\n\u2502\n\u251c\u2500\u2500 generated_scrapers/              # AI-generated code\n\u2502   \u251c\u2500\u2500 ranchi/\n\u2502   \u2502   \u251c\u2500\u2500 ranchi_complaint_form_scraper.py\n\u2502   \u2502   \u251c\u2500\u2500 ranchi_status_checker_scraper.py\n\u2502   \u2502   \u2514\u2500\u2500 __init__.py\n\u2502   \u2514\u2500\u2500 patna/\n\u2502       \u2514\u2500\u2500 ...\n\u2502\n\u2514\u2500\u2500 executor/\n    \u2514\u2500\u2500 results/                     # Execution results\n        \u251c\u2500\u2500 ranchi_complaint_form_20231223_120045.json\n        \u2514\u2500\u2500 ranchi_status_check_20231223_120145.json",
          "description": "- `GET /api/municipalities` - List configs",
          "context": "t scrapers\n- `GET /api/municipalities` - List configs\n\n## \ud83d\uddc4\ufe0f Data Storage\n\n### File System Structure"
        },
        {
          "language": "json",
          "code": "{\n  \"ranchi\": {\n    \"name\": \"Ranchi Municipal Corporation\",\n    \"websites\": [\n      {\n        \"url\": \"https://...\",\n        \"type\": \"complaint_form\",\n        \"description\": \"...\"\n      }\n    ],\n    \"generated_scrapers\": [\n      {\n        \"file_path\": \"generated_scrapers/ranchi/...\",\n        \"metadata\": {\n          \"generated_at\": \"2023-12-23T12:00:00\",\n          \"url\": \"...\",\n          \"website_type\": \"complaint_form\"\n        }\n      }\n    ],\n    \"last_updated\": \"2023-12-23T12:00:00\"\n  }\n}",
          "description": "```",
          "context": "120045.json\n        \u2514\u2500\u2500 ranchi_status_check_20231223_120145.json\n```\n\n### municipalities.json Schema"
        },
        {
          "language": "json",
          "code": "{\n  \"timestamp\": \"20231223_120045\",\n  \"municipality\": \"ranchi\",\n  \"website_type\": \"complaint_form\",\n  \"input_data\": {\n    \"name\": \"John Doe\",\n    \"complaint\": \"...\"\n  },\n  \"result\": {\n    \"success\": true,\n    \"tracking_id\": \"RMC123\",\n    \"screenshots\": [\"path/to/screenshot.png\"],\n    \"execution_time\": 5.2,\n    \"attempts\": 1\n  }\n}",
          "description": "```",
          "context": "   }\n      }\n    ],\n    \"last_updated\": \"2023-12-23T12:00:00\"\n  }\n}\n```\n\n### Execution Result Schema"
        },
        {
          "language": "python",
          "code": "from slowapi import Limiter\n\n@app.post(\"/api/submit\")\n@limiter.limit(\"10/minute\")\nasync def submit_grievance(...):\n    ...",
          "description": "- Each execution starts fresh",
          "context": "ntext\n- No persistent cookies/storage\n- Each execution starts fresh\n\n### Rate Limiting (Recommended)"
        },
        {
          "language": "python",
          "code": "for attempt in range(max_retries + 1):\n    try:\n        result = await scraper.submit_grievance(data)\n        if result['success']:\n            return result\n        await asyncio.sleep(2)  # Wait before retry\n    except Exception as e:\n        if attempt < max_retries:\n            continue\n        return error_result",
          "description": "- **Solution:** Horizontal scaling with multiple workers",
          "context": "ution:** Horizontal scaling with multiple workers\n\n## \ud83d\udd04 Error Handling & Resilience\n\n### Retry Logic"
        },
        {
          "language": "bash",
          "code": "uvicorn main:app --host 0.0.0.0 --port 8000",
          "description": "| Import error | Scraper not found | Run learning |",
          "context": "ort error | Scraper not found | Run learning |\n\n## \ud83d\ude80 Deployment Options\n\n### Option 1: Single Server"
        },
        {
          "language": "dockerfile",
          "code": "FROM python:3.11\nRUN playwright install chromium --with-deps\nCMD [\"uvicorn\", \"main:app\"]",
          "description": "```",
          "context": "ption 1: Single Server\n```bash\nuvicorn main:app --host 0.0.0.0 --port 8000\n```\n\n### Option 2: Docker"
        },
        {
          "language": "yaml",
          "code": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: grivredr\nspec:\n  replicas: 3\n  template:\n    spec:\n      containers:\n      - name: grivredr\n        image: grivredr:latest\n        env:\n        - name: api_key\n          valueFrom:\n            secretKeyRef:\n              name: grivredr-secrets\n              key: api-key",
          "description": "```",
          "context": "UN playwright install chromium --with-deps\nCMD [\"uvicorn\", \"main:app\"]\n```\n\n### Option 3: Kubernetes"
        },
        {
          "language": "python",
          "code": "import logging\n\nlogger.info(f\"Submitting to {municipality}\")\nlogger.warning(f\"Retry attempt {attempt}\")\nlogger.error(f\"Submission failed: {error}\")",
          "description": "- Scraper failure rate",
          "context": "ess rate by municipality\n- Average execution time\n- AI API costs\n- Scraper failure rate\n\n### Logging"
        },
        {
          "language": "python",
          "code": "@app.get(\"/health\")\nasync def health_check():\n    return {\n        \"status\": \"healthy\",\n        \"scrapers_count\": len(list_scrapers()),\n        \"ai_client\": \"connected\"\n    }",
          "description": "```",
          "context": "rning(f\"Retry attempt {attempt}\")\nlogger.error(f\"Submission failed: {error}\")\n```\n\n### Health Checks"
        }
      ],
      "patterns": [],
      "best_practices": [],
      "architecture_notes": [
        "\u2502 (Sonnet 4.5)     \u2502     Return JSON\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u25bc\n{\n  \"form_fields\": [\n    {\"label\": \"Name\", \"selector\": \"#name\", ...},\n    {\"label\": \"Phone\", \"selector\": \"#phone\", ...}\n  ],\n  \"submit_button\": {\"selector\": \"#submit\"},",
        "- `generate_scraper_code()` - Code generation\n- `improve_scraper_with_feedback()` - Self-healing\n- `extract_status_from_page()` - Status parsing",
        "- \u2705 Cost efficiency (AI only during learning)\n- \u2705 Scalability (generated code runs without AI)\n- \u2705 Resilience (retries, self-healing)\n- \u2705 Maintainability (clear separation of concerns)"
      ]
    },
    {
      "title": "Grivredr - Complete Implementation Roadmap",
      "file_path": "IMPLEMENTATION_ROADMAP.md",
      "key_concepts": [
        "Grivredr - Complete Implementation Roadmap",
        "\ud83c\udfaf Project Vision",
        "The Problem We're Solving",
        "\ud83c\udfd7\ufe0f System Architecture (Detailed)",
        "\ud83d\udce6 Complete Component Breakdown",
        "1. Core Agent Framework",
        "2. Form Discovery Agent",
        "3. Test Validation Agent",
        "4. JavaScript Analyzer Agent",
        "5. Code Generator Agent",
        "generated_scrapers/ranchi/smart_portal_scraper.py",
        "6. Orchestrator",
        "7. Knowledge Base",
        "8. Flask Dashboard",
        "\ud83d\udccb Complete File Structure",
        "\ud83c\udfaf Implementation Phases",
        "Phase 1: Core Agent Framework (Week 1)",
        "Phase 2: Intelligence Layer (Week 2)",
        "Phase 3: Testing & Validation (Week 3)",
        "Phase 4: Production (Week 4)",
        "\ud83d\udcb0 Estimated Costs",
        "Training Phase (Per Municipality)",
        "With Human Training",
        "ROI Example",
        "\ud83e\uddea Testing Strategy",
        "Unit Tests",
        "tests/unit/test_form_discovery.py",
        "Integration Tests",
        "tests/integration/test_training_flow.py",
        "E2E Tests",
        "tests/e2e/test_smart_ranchi.py",
        "\ud83d\ude80 Getting Started (After Implementation)",
        "1. Install dependencies",
        "2. Start Flask dashboard",
        "3. Open browser",
        "http://localhost:5000",
        "4. Start training session",
        "Click \"New Training\" \u2192 Enter Smart Ranchi URL \u2192 Watch agents work",
        "5. Test generated scraper"
      ],
      "code_examples": [
        {
          "language": "text",
          "code": "\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                     FLASK DASHBOARD (Port 5000)                  \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502  Training  \u2502  \u2502   Live     \u2502  \u2502   Scraper  \u2502  \u2502   Cost    \u2502 \u2502\n\u2502  \u2502  Sessions  \u2502  \u2502 Monitoring \u2502  \u2502  Library   \u2502  \u2502 Dashboard \u2502 \u2502\n\u2502  \u2502            \u2502  \u2502            \u2502  \u2502            \u2502  \u2502           \u2502 \u2502\n\u2502  \u2502 \u2022 Guide    \u2502  \u2502 \u2022 Agent    \u2502  \u2502 \u2022 View all \u2502  \u2502 \u2022 Per-muni\u2502 \u2502\n\u2502  \u2502   agent    \u2502  \u2502   status   \u2502  \u2502 \u2022 Test     \u2502  \u2502 \u2022 Per-    \u2502 \u2502\n\u2502  \u2502 \u2022 Correct  \u2502  \u2502 \u2022 Actions  \u2502  \u2502 \u2022 Edit     \u2502  \u2502   agent   \u2502 \u2502\n\u2502  \u2502   errors   \u2502  \u2502 \u2022 Costs    \u2502  \u2502 \u2022 Deploy   \u2502  \u2502 \u2022 Live $  \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                            \u2502\n                            \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    ORCHESTRATOR AGENT                            \u2502\n\u2502  \u2022 Manages training sessions                                     \u2502\n\u2502  \u2022 Coordinates sub-agents                                        \u2502\n\u2502  \u2022 Handles human-in-loop workflow                                \u2502\n\u2502  \u2022 Persists knowledge base                                       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n             \u2502\n             \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n             \u25bc              \u25bc              \u25bc              \u25bc\n   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n   \u2502 FormDiscovery   \u2502 \u2502 TestAgent  \u2502 \u2502 JSAnalyzer  \u2502 \u2502 CodeGen      \u2502\n   \u2502 Agent           \u2502 \u2502            \u2502 \u2502 Agent       \u2502 \u2502 Agent        \u2502\n   \u2502                 \u2502 \u2502            \u2502 \u2502             \u2502 \u2502              \u2502\n   \u2502 \u2022 Crawl form    \u2502 \u2502 \u2022 Submit   \u2502 \u2502 \u2022 Analyze   \u2502 \u2502 \u2022 Generate   \u2502\n   \u2502 \u2022 Find fields   \u2502 \u2502   tests    \u2502 \u2502   JS logic  \u2502 \u2502   Python     \u2502\n   \u2502 \u2022 Map types     \u2502 \u2502 \u2022 Validate \u2502 \u2502 \u2022 Detect    \u2502 \u2502 \u2022 Add error  \u2502\n   \u2502 \u2022 Detect deps   \u2502 \u2502 \u2022 Capture  \u2502 \u2502   AJAX      \u2502 \u2502   handling   \u2502\n   \u2502 \u2022 Screenshot    \u2502 \u2502   errors   \u2502 \u2502 \u2022 Extract   \u2502 \u2502 \u2022 Test it    \u2502\n   \u2502 \u2022 Claude Vision \u2502 \u2502 \u2022 Retry    \u2502 \u2502   patterns  \u2502 \u2502              \u2502\n   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n             \u2502              \u2502              \u2502              \u2502\n             \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                            \u2502\n                            \u25bc\n                  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                  \u2502  KNOWLEDGE BASE    \u2502\n                  \u2502  (SQLite/JSON)     \u2502\n                  \u2502                    \u2502\n                  \u2502 \u2022 Field patterns   \u2502\n                  \u2502 \u2022 Validation rules \u2502\n                  \u2502 \u2022 JS patterns      \u2502\n                  \u2502 \u2022 Success stories  \u2502\n                  \u2502 \u2022 Human feedback   \u2502\n                  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                            \u2502\n                            \u25bc\n                  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                  \u2502 GENERATED SCRAPERS \u2502\n                  \u2502 (Python files)     \u2502\n                  \u2502                    \u2502\n                  \u2502 \u2022 Validated code   \u2502\n                  \u2502 \u2022 Test suite       \u2502\n                  \u2502 \u2022 Documentation    \u2502\n                  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518",
          "description": "---",
          "context": "tion-ready code\n6. **Validate** through automated testing\n\n---\n\n## \ud83c\udfd7\ufe0f System Architecture (Detailed)"
        },
        {
          "language": "python",
          "code": "class MyAgent(BaseAgent):\n    async def _execute_attempt(self, task):\n        # Your logic here\n        return {\"success\": True, \"data\": \"...\"}\n\nagent = MyAgent(\"MyAgent\", max_attempts=3)\nresult = await agent.execute(task)",
          "description": "**Usage**:",
          "context": " recording for debugging\n- Status callbacks for Flask UI\n- Strategy planning with Claude\n\n**Usage**:"
        },
        {
          "language": "python",
          "code": "FormSchema(\n    url=\"https://smartranchi.in/...\",\n    fields=[\n        Field(\n            name=\"select_type\",\n            label=\"Select Type\",\n            type=\"dropdown\",\n            required=True,\n            options=[\"Electrical\", \"Water\", ...],\n            validation=\"required\"\n        ),\n        Field(\n            name=\"problem\",\n            label=\"Problem\",\n            type=\"dropdown\",\n            required=True,\n            depends_on=\"select_type\",  # Cascading!\n            validation=\"required\"\n        ),\n        # ... more fields\n    ],\n    submit_button=Button(selector=\"button.submit\", text=\"Register Complaint\"),\n    submission_type=\"ajax\",  # vs \"form_post\"\n    success_indicator={\"type\": \"text\", \"contains\": \"Complaint registered\"}\n)",
          "description": "**Output**:",
          "context": "l fields?\"\n   - \"Are there fields below the fold?\"\n   - \"Are there multi-step wizards?\"\n\n**Output**:"
        },
        {
          "language": "python",
          "code": "async def test_empty_form():\n       result = await submit_form({})\n       assert \"Mobile No is required\" in result.errors\n       assert \"Select Type is required\" in result.errors\n   ```\n\n2. **Test Required Fields Only**\n   ```python\n   async def test_minimal_valid():\n       result = await submit_form({\n           \"mobile\": \"9876543210\",\n           \"select_type\": \"Electrical\",\n           \"problem\": \"Street light\"\n       })\n       assert result.success or has_new_errors(result)\n   ```\n\n3. **Test Field Types**\n   ```python\n   async def test_mobile_validation():\n       result = await submit_form({\"mobile\": \"123\"})  # Invalid\n       assert \"invalid mobile\" in result.errors.lower()\n   ```\n\n4. **Test Cascading Dropdowns**\n   ```python\n   async def test_problem_depends_on_type():\n       # Select type first\n       await select_dropdown(\"select_type\", \"Electrical\")\n       await wait_for_update()\n\n       # Check if problem dropdown populated\n       options = await get_dropdown_options(\"problem\")\n       assert len(options) > 0\n   ```\n\n5. **Test Full Submission**\n   ```python\n   async def test_complete_submission():\n       result = await submit_form(complete_test_data)\n       assert result.success\n       assert result.tracking_id is not None\n   ```\n\n**Output**:",
          "description": "1. **Test Empty Submission**",
          "context": "alidate discovered form schema through actual testing\n\n**Test Suite**:\n\n1. **Test Empty Submission**"
        },
        {
          "language": "text",
          "code": "---\n\n### 4. JavaScript Analyzer Agent\n\n**File**: `agents/js_analyzer_agent.py`\n\n**Purpose**: Understand JavaScript form logic\n\n**Analysis Steps**:\n\n1. **Inject Monitoring Code**\n   ```javascript\n   // Injected into page\n   window._grivredr_monitor = {\n       xhr_calls: [],\n       form_events: [],\n       validations: []\n   };\n\n   // Hook into XMLHttpRequest\n   const oldXHR = window.XMLHttpRequest;\n   window.XMLHttpRequest = function() {\n       const xhr = new oldXHR();\n       // Track all AJAX calls\n   };\n   ```\n\n2. **Detect Form Submission Method**\n   - Standard form POST?\n   - AJAX with fetch()?\n   - jQuery $.ajax()?\n   - Custom framework?\n\n3. **Extract Validation Logic**\n   ```javascript\n   // Find validation functions\n   if (form.onsubmit) {\n       // Analyze onsubmit handler\n   }\n\n   // Check for validation libraries\n   if (window.jQuery && $.validator) {\n       // jQuery Validation plugin\n   }\n   ```\n\n4. **Identify Dynamic Behaviors**\n   - Which fields trigger onChange events?\n   - Which dropdowns populate others?\n   - Are there AJAX calls to fetch data?\n\n5. **Claude Analysis**\n   ```python\n   # Send captured JS events to Claude\n   prompt = \"\"\"Analyze this JavaScript form behavior:\n\n   XHR Calls: {xhr_calls}\n   Form Events: {form_events}\n\n   Explain:\n   1. How is this form submitted?\n   2. What validation happens client-side?\n   3. What can be replicated in Python vs needs browser?\n   \"\"\"\n   ```\n\n**Output**:",
          "description": ")",
          "context": "d_schema=FormSchema(...),  # Updated based on tests\n    confidence_score=0.875  # 7/8 tests passed\n)"
        },
        {
          "language": "text",
          "code": "---\n\n### 5. Code Generator Agent\n\n**File**: `agents/code_generator_agent.py`\n\n**Purpose**: Generate production-ready scraper from validated schema\n\n**Generation Process**:\n\n1. **Template Selection**\n   - Simple form (requests library)\n   - Complex form (Playwright needed)\n   - Hybrid (requests + Playwright for specific parts)\n\n2. **Code Generation with Claude Opus**\n   ```python\n   prompt = \"\"\"Generate a production-ready Python scraper.\n\n   Form Schema: {validated_schema}\n   JS Analysis: {js_analysis}\n   Test Results: {test_results}\n\n   Requirements:\n   - Handle cascading dropdowns\n   - Implement proper error handling\n   - Add retries for network issues\n   - Take screenshots on failure\n   - Return structured result with tracking ID\n   - Include docstrings and type hints\n\n   Generate complete Python code.\"\"\"\n   ```\n\n3. **Code Validation**\n   - Syntax check (ast.parse)\n   - Run through black formatter\n   - Add to test suite\n\n4. **Self-Testing**\n   ```python\n   # Generated code must pass these tests\n   async def test_generated_scraper():\n       scraper = load_scraper(\"ranchi_smart_portal\")\n       result = await scraper.submit(test_data)\n       assert result.success\n       assert result.tracking_id\n   ```\n\n**Output**: Production-ready Python file",
          "description": ")",
          "context": " populated via AJAX when Type selected\",\n        \"File upload requires csrf token from page\"\n    ]\n)"
        },
        {
          "language": "text",
          "code": "---\n\n### 6. Orchestrator\n\n**File**: `agents/orchestrator.py`\n\n**Purpose**: Coordinate all agents and manage training sessions\n\n**Workflow**:",
          "description": "\"\"\"",
          "context": "               \"cost\": 0.0  # No AI cost!\n            }\n        \"\"\"\n        # Full implementation..."
        },
        {
          "language": "text",
          "code": "---\n\n### 7. Knowledge Base\n\n**File**: `knowledge/knowledge_base.py`\n\n**Purpose**: Store and retrieve learned patterns\n\n**Schema**:",
          "description": "return await self.request_human_help()",
          "context": "r.path}\n        else:\n            # Back to human\n            return await self.request_human_help()"
        },
        {
          "language": "text",
          "code": "**Learned Patterns Examples**:",
          "description": ");",
          "context": "XT,\n    end_time TEXT,\n    total_cost FLOAT,\n    human_interventions INTEGER,\n    success BOOLEAN\n);"
        },
        {
          "language": "text",
          "code": "---\n\n### 8. Flask Dashboard\n\n**File**: `dashboard/app.py`\n\n**Pages**:\n\n1. **Home** (`/`)\n   - Overview stats\n   - Active training sessions\n   - Total municipalities\n   - Cost today/week/month\n\n2. **Training** (`/train`)\n   - Start new training session\n   - Enter URL, municipality name\n   - Live progress view\n   - Human intervention UI\n\n3. **Monitor** (`/monitor`)\n   - WebSocket real-time updates\n   - Agent status cards\n   - Action log stream\n   - Cost ticker\n\n4. **Scrapers** (`/scrapers`)\n   - List all municipalities\n   - View generated code\n   - Run tests\n   - Deploy/undeploy\n\n5. **Costs** (`/costs`)\n   - Per-municipality breakdown\n   - Per-agent breakdown\n   - Daily/weekly/monthly charts\n   - ROI calculator\n\n6. **Knowledge** (`/knowledge`)\n   - Browse learned patterns\n   - Search patterns\n   - Pattern confidence scores\n\n**Tech Stack**:\n- Flask + Flask-SocketIO (real-time)\n- Bootstrap 5 (UI)\n- Chart.js (cost charts)\n- DataTables (scraper library)\n\n---\n\n## \ud83d\udccb Complete File Structure",
          "description": "}",
          "context": "\": \"Please enter valid 10 digit mobile number\"\n    },\n    \"confidence\": 0.98,\n    \"times_seen\": 50\n}"
        },
        {
          "language": "text",
          "code": "---\n\n## \ud83c\udfaf Implementation Phases\n\n### Phase 1: Core Agent Framework (Week 1)\n- [x] BaseAgent with reflection\n- [ ] FormDiscoveryAgent\n- [ ] TestAgent\n- [ ] Orchestrator\n- [ ] Knowledge base\n- [ ] Basic Flask dashboard\n\n### Phase 2: Intelligence Layer (Week 2)\n- [ ] JSAnalyzerAgent\n- [ ] CodeGeneratorAgent\n- [ ] Human-in-loop UI\n- [ ] Pattern learning\n- [ ] Cost tracking dashboard\n\n### Phase 3: Testing & Validation (Week 3)\n- [ ] TDD framework with pytest\n- [ ] Train on Smart Ranchi\n- [ ] Train on Jharkhand portal\n- [ ] Validate reliability\n- [ ] Performance optimization\n\n### Phase 4: Production (Week 4)\n- [ ] FastAPI integration\n- [ ] Monitoring & alerting\n- [ ] Deployment automation\n- [ ] Documentation\n\n---\n\n## \ud83d\udcb0 Estimated Costs\n\n### Training Phase (Per Municipality)\n\n| Component | API Calls | Est. Cost |\n|-----------|-----------|-----------|\n| Form Discovery | 3-5 Vision + 5-8 Sonnet | $0.30 |\n| JS Analysis | 2-3 Opus | $0.20 |\n| Test Validation | 5-10 Haiku | $0.03 |\n| Code Generation | 1-2 Opus | $0.15 |\n| Refinement (if needed) | 2-3 Sonnet | $0.10 |\n| **Total per website** | | **~$0.78** |\n\n### With Human Training\n- First website in a region: **~$1.20**\n- Similar websites (patterns learned): **~$0.30**\n- Execution forever: **$0.00**\n\n### ROI Example",
          "description": "\u2514\u2500\u2500 main.py                        (Entry point)",
          "context": "E.md\n\u251c\u2500\u2500 IMPLEMENTATION_ROADMAP.md      \u2705 THIS FILE\n\u2514\u2500\u2500 main.py                        (Entry point)"
        },
        {
          "language": "text",
          "code": "---\n\n## \ud83e\uddea Testing Strategy\n\n### Unit Tests",
          "description": "ROI: 98% savings",
          "context": "5-20 (one-time)\nAnnual submissions: 10,000\nExecution cost: $0 (vs Skyvern: $1,000)\n\nROI: 98% savings"
        },
        {
          "language": "text",
          "code": "### Integration Tests",
          "description": "pass",
          "context": "].required == True\n\ndef test_cascading_dropdown_detection():\n    # Test pattern recognition\n    pass"
        },
        {
          "language": "text",
          "code": "### E2E Tests",
          "description": "assert result[\"scraper_path\"].exists()",
          "context": " municipality=\"ranchi\"\n    )\n    assert result[\"success\"]\n    assert result[\"scraper_path\"].exists()"
        },
        {
          "language": "text",
          "code": "---\n\n## \ud83d\ude80 Getting Started (After Implementation)",
          "description": "assert result[\"tracking_id\"]",
          "context": "it scraper.submit_grievance(test_data)\n    assert result[\"success\"]\n    assert result[\"tracking_id\"]"
        }
      ],
      "patterns": [],
      "best_practices": [],
      "architecture_notes": [
        "\u2514\u2500\u2500 main.py                        (Entry point)\n```"
      ]
    },
    {
      "title": "Grivredr Usage Guide",
      "file_path": "USAGE_GUIDE.md",
      "key_concepts": [
        "Grivredr Usage Guide",
        "\ud83c\udfaf Quick Start (5 Minutes)",
        "Step 1: Test AI Connection",
        "Step 2: Learn Ranchi Websites (First Time Only)",
        "Step 3: Test Generated Scrapers",
        "Step 4: Start API Server",
        "\ud83d\udccb Detailed Workflows",
        "Workflow A: Onboard New Municipality",
        "Method 1: Via Python Script",
        "add_patna.py",
        "Method 2: Via API",
        "Workflow B: Submit Grievance",
        "Method 1: Via API",
        "Method 2: Via Python",
        "Workflow C: Batch Submission",
        "Workflow D: Check Status",
        "\ud83d\udd0d Understanding the System",
        "How AI Learning Works",
        "Generated Scraper Structure",
        "Cost Breakdown",
        "Learning Phase (One-time per website)",
        "Execution Phase (Repeated)",
        "\ud83c\udf9b\ufe0f Configuration",
        "AI Models",
        "Browser Settings",
        "Retries & Timeouts",
        "\ud83d\udcca Monitoring & Debugging",
        "View Available Scrapers",
        "Check Learning Results",
        "View Generated Code",
        "Execution Results",
        "Screenshots",
        "\ud83d\udc1b Troubleshooting",
        "Issue: \"Scraper not found\"",
        "Issue: \"Failed to parse AI analysis\"",
        "Issue: Scraper fails during execution",
        "Issue: Website structure changed",
        "Deletes old scraper and regenerates",
        "\ud83d\ude80 Production Deployment",
        "1. Use Docker",
        "2. Environment Variables",
        "3. Add Rate Limiting",
        "4. Background Task Queue",
        "\ud83d\udcc8 Scaling",
        "For High Volume (1000+ submissions/day)",
        "\ud83d\udd10 Security",
        "API Key Protection",
        "Input Validation",
        "Rate Limiting",
        "\ud83d\udcde WhatsApp Integration (Future)",
        "\ud83c\udf93 Learning Resources",
        "\ud83d\udca1 Tips & Best Practices",
        "\ud83e\udd1d Need Help?"
      ],
      "code_examples": [
        {
          "language": "bash",
          "code": "python3 test_ai_client.py",
          "description": "",
          "context": "# Grivredr Usage Guide\n\n## \ud83c\udfaf Quick Start (5 Minutes)\n\n### Step 1: Test AI Connection"
        },
        {
          "language": "bash",
          "code": "python3 learn_ranchi.py",
          "description": "You should see: `\u2705 Success! Response: Hello from Claude!`",
          "context": " see: `\u2705 Success! Response: Hello from Claude!`\n\n### Step 2: Learn Ranchi Websites (First Time Only)"
        },
        {
          "language": "bash",
          "code": "python3 test_scrapers.py",
          "description": "**Duration:** 2-5 minutes per website",
          "context": "erated_scrapers/ranchi/`\n\n**Duration:** 2-5 minutes per website\n\n### Step 3: Test Generated Scrapers"
        },
        {
          "language": "bash",
          "code": "python3 main.py",
          "description": "- Returns tracking ID (if successful)",
          "context": "crapers\n- Submits test grievance\n- Returns tracking ID (if successful)\n\n### Step 4: Start API Server"
        },
        {
          "language": "python",
          "code": "# add_patna.py\nimport asyncio\nfrom website_learner.learner import WebsiteLearner\nfrom scraper_generator.generator import ScraperGenerator\n\nasync def add_patna():\n    patna_websites = [\n        {\n            \"url\": \"https://patna.gov.in/complaint-form\",\n            \"type\": \"complaint_form\",\n            \"description\": \"Patna Municipal Corporation complaint form\"\n        }\n    ]\n\n    # Learn\n    async with WebsiteLearner(headless=False) as learner:\n        results = await learner.learn_multiple_websites(\n            websites=patna_websites,\n            municipality_name=\"patna\"\n        )\n\n    # Generate scrapers\n    generator = ScraperGenerator()\n    generation = generator.generate_scrapers_for_municipality(\n        learning_results=results,\n        municipality_name=\"patna\"\n    )\n\n    print(f\"Generated {generation['generated_count']} scrapers\")\n\nasyncio.run(add_patna())",
          "description": "**Scenario:** You want to add support for a new city (e.g., Patna)",
          "context": "**Scenario:** You want to add support for a new city (e.g., Patna)\n\n#### Method 1: Via Python Script"
        },
        {
          "language": "bash",
          "code": "curl -X POST http://localhost:8000/api/learn \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"municipality_name\": \"patna\",\n    \"websites\": [\n      {\n        \"url\": \"https://patna.gov.in/complaint-form\",\n        \"type\": \"complaint_form\",\n        \"description\": \"Patna complaint form\"\n      }\n    ],\n    \"headless\": true,\n    \"generate_scrapers\": true\n  }'",
          "description": "Run: `python3 add_patna.py`",
          "context": "unt']} scrapers\")\n\nasyncio.run(add_patna())\n```\n\nRun: `python3 add_patna.py`\n\n#### Method 2: Via API"
        },
        {
          "language": "bash",
          "code": "curl -X POST http://localhost:8000/api/submit \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"municipality\": \"ranchi\",\n    \"website_type\": \"complaint_form\",\n    \"grievance_data\": {\n      \"name\": \"Rajesh Kumar\",\n      \"phone\": \"9876543210\",\n      \"email\": \"rajesh@example.com\",\n      \"complaint\": \"Broken footpath causing accidents\",\n      \"category\": \"Roads & Infrastructure\",\n      \"address\": \"Main Road, Doranda, Ranchi\"\n    }\n  }'",
          "description": "```",
          "context": "ue,\n    \"generate_scrapers\": true\n  }'\n```\n\n### Workflow B: Submit Grievance\n\n#### Method 1: Via API"
        },
        {
          "language": "json",
          "code": "{\n  \"success\": true,\n  \"tracking_id\": \"RMC20231223001\",\n  \"message\": \"Grievance submitted successfully\",\n  \"municipality\": \"ranchi\",\n  \"execution_time\": 5.2,\n  \"screenshots\": [\"path/to/screenshot.png\"]\n}",
          "description": "Response:",
          "context": "\": \"Roads & Infrastructure\",\n      \"address\": \"Main Road, Doranda, Ranchi\"\n    }\n  }'\n```\n\nResponse:"
        },
        {
          "language": "python",
          "code": "import asyncio\nfrom executor.runner import ScraperExecutor\n\nasync def submit():\n    executor = ScraperExecutor()\n\n    result = await executor.execute_scraper(\n        municipality_name=\"ranchi\",\n        website_type=\"complaint_form\",\n        grievance_data={\n            \"name\": \"Rajesh Kumar\",\n            \"phone\": \"9876543210\",\n            \"complaint\": \"Broken footpath\",\n            \"category\": \"Infrastructure\"\n        }\n    )\n\n    if result['success']:\n        print(f\"\u2705 Submitted! Tracking ID: {result['tracking_id']}\")\n    else:\n        print(f\"\u274c Failed: {result['error']}\")\n\nasyncio.run(submit())",
          "description": "```",
          "context": " \"execution_time\": 5.2,\n  \"screenshots\": [\"path/to/screenshot.png\"]\n}\n```\n\n#### Method 2: Via Python"
        },
        {
          "language": "bash",
          "code": "curl -X POST http://localhost:8000/api/submit/batch \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"submissions\": [\n      {\n        \"municipality\": \"ranchi\",\n        \"website_type\": \"complaint_form\",\n        \"grievance_data\": {\"name\": \"Person 1\", \"complaint\": \"Issue 1\"}\n      },\n      {\n        \"municipality\": \"ranchi\",\n        \"website_type\": \"complaint_form\",\n        \"grievance_data\": {\"name\": \"Person 2\", \"complaint\": \"Issue 2\"}\n      }\n    ]\n  }'",
          "description": "Submit multiple grievances at once:",
          "context": "\")\n\nasyncio.run(submit())\n```\n\n### Workflow C: Batch Submission\n\nSubmit multiple grievances at once:"
        },
        {
          "language": "bash",
          "code": "curl -X POST http://localhost:8000/api/status \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"municipality\": \"ranchi\",\n    \"tracking_id\": \"RMC20231223001\"\n  }'",
          "description": "```",
          "context": "\": {\"name\": \"Person 2\", \"complaint\": \"Issue 2\"}\n      }\n    ]\n  }'\n```\n\n### Workflow D: Check Status"
        },
        {
          "language": "text",
          "code": "User provides URL\n       \u2193\nPlaywright opens browser\n       \u2193\nNavigate to website, click relevant links\n       \u2193\nTake full-page screenshot\n       \u2193\nExtract HTML form structure\n       \u2193\nSend to Claude Vision:\n  - Screenshot (base64)\n  - HTML snippet\n  - URL context\n       \u2193\nClaude analyzes and returns JSON:\n  {\n    \"form_fields\": [...],\n    \"submit_button\": {...},\n    \"navigation_steps\": [...]\n  }\n       \u2193\nClaude Opus generates Python code:\n  - Playwright automation script\n  - Error handling\n  - Screenshot capture\n  - Retry logic\n       \u2193\nSave as Python file",
          "description": "```",
          "context": "  \"tracking_id\": \"RMC20231223001\"\n  }'\n```\n\n## \ud83d\udd0d Understanding the System\n\n### How AI Learning Works"
        },
        {
          "language": "python",
          "code": "class RanchiScraper:\n    async def submit_grievance(self, data: dict) -> dict:\n        \"\"\"\n        Args:\n            data: {\n                \"name\": str,\n                \"phone\": str,\n                \"complaint\": str,\n                ...\n            }\n\n        Returns:\n            {\n                \"success\": bool,\n                \"tracking_id\": str,\n                \"screenshots\": list,\n                \"error\": str (if failed)\n            }\n        \"\"\"\n        # AI-generated automation code\n        pass",
          "description": "Each scraper is a Python class:",
          "context": "c\n       \u2193\nSave as Python file\n```\n\n### Generated Scraper Structure\n\nEach scraper is a Python class:"
        },
        {
          "language": "python",
          "code": "self.models = {\n    \"fast\": \"claude-haiku-4-5-20251001\",      # Quick tasks\n    \"balanced\": \"claude-sonnet-4-5-20250929\",  # Most tasks\n    \"powerful\": \"claude-opus-4-5-20251101\",    # Code generation\n}",
          "description": "Edit `config/ai_client.py` to change models:",
          "context": "s = $0.00 AI costs\n\n## \ud83c\udf9b\ufe0f Configuration\n\n### AI Models\n\nEdit `config/ai_client.py` to change models:"
        },
        {
          "language": "python",
          "code": "WebsiteLearner(headless=True)  # Set False to see browser",
          "description": "In `website_learner/learner.py`:",
          "context": "us-4-5-20251101\",    # Code generation\n}\n```\n\n### Browser Settings\n\nIn `website_learner/learner.py`:"
        },
        {
          "language": "python",
          "code": "await executor.execute_scraper(\n    ...,\n    max_retries=2  # Change retry count\n)",
          "description": "In `executor/runner.py`:",
          "context": "ner(headless=True)  # Set False to see browser\n```\n\n### Retries & Timeouts\n\nIn `executor/runner.py`:"
        },
        {
          "language": "bash",
          "code": "curl http://localhost:8000/api/scrapers",
          "description": "```",
          "context": " max_retries=2  # Change retry count\n)\n```\n\n## \ud83d\udcca Monitoring & Debugging\n\n### View Available Scrapers"
        },
        {
          "language": "bash",
          "code": "cat website_learner/results_ranchi.json",
          "description": "```",
          "context": " Available Scrapers\n\n```bash\ncurl http://localhost:8000/api/scrapers\n```\n\n### Check Learning Results"
        },
        {
          "language": "bash",
          "code": "cat generated_scrapers/ranchi/ranchi_complaint_form_scraper.py",
          "description": "```",
          "context": "Check Learning Results\n\n```bash\ncat website_learner/results_ranchi.json\n```\n\n### View Generated Code"
        },
        {
          "language": "bash",
          "code": "ls -lt executor/results/ | head -5",
          "description": "Saved in: `executor/results/`",
          "context": "rs/ranchi/ranchi_complaint_form_scraper.py\n```\n\n### Execution Results\n\nSaved in: `executor/results/`"
        },
        {
          "language": "bash",
          "code": "python3 learn_ranchi.py",
          "description": "**Solution:** Run learning first:",
          "context": "PI response\n\n## \ud83d\udc1b Troubleshooting\n\n### Issue: \"Scraper not found\"\n\n**Solution:** Run learning first:"
        },
        {
          "language": "python",
          "code": "from scraper_generator.generator import ScraperGenerator\n\ngenerator = ScraperGenerator()\nresult = generator.refine_scraper_with_feedback(\n    scraper_path=\"generated_scrapers/ranchi/ranchi_complaint_form_scraper.py\",\n    error_log=\"Error: Submit button not found\",\n    screenshot_base64=\"...\"  # Optional\n)",
          "description": "**Solution 2:** Refine scraper using AI feedback:",
          "context": "ion 1:** Check screenshots to see where it failed\n\n**Solution 2:** Refine scraper using AI feedback:"
        },
        {
          "language": "bash",
          "code": "# Deletes old scraper and regenerates\npython3 learn_ranchi.py",
          "description": "**Solution:** Re-learn the website:",
          "context": "4=\"...\"  # Optional\n)\n```\n\n### Issue: Website structure changed\n\n**Solution:** Re-learn the website:"
        },
        {
          "language": "dockerfile",
          "code": "FROM python:3.11\n\nWORKDIR /app\n\nCOPY requirements.txt .\nRUN pip install -r requirements.txt\nRUN playwright install chromium --with-deps\n\nCOPY . .\n\nCMD [\"uvicorn\", \"main:app\", \"--host\", \"0.0.0.0\", \"--port\", \"8000\"]",
          "description": "```",
          "context": "d scraper and regenerates\npython3 learn_ranchi.py\n```\n\n## \ud83d\ude80 Production Deployment\n\n### 1. Use Docker"
        },
        {
          "language": "bash",
          "code": "export api_key=\"your-api-key\"",
          "description": "```",
          "context": "CMD [\"uvicorn\", \"main:app\", \"--host\", \"0.0.0.0\", \"--port\", \"8000\"]\n```\n\n### 2. Environment Variables"
        },
        {
          "language": "python",
          "code": "from slowapi import Limiter\n\nlimiter = Limiter(key_func=lambda: \"global\")\n\n@app.post(\"/api/submit\")\n@limiter.limit(\"10/minute\")\nasync def submit_grievance(...):\n    ...",
          "description": "```",
          "context": "`\n\n### 2. Environment Variables\n\n```bash\nexport api_key=\"your-api-key\"\n```\n\n### 3. Add Rate Limiting"
        },
        {
          "language": "python",
          "code": "from celery import Celery\n\ncelery = Celery('grivredr', broker='redis://localhost:6379')\n\n@celery.task\ndef learn_website_task(municipality, websites):\n    # Learning logic\n    pass",
          "description": "Use Celery or RQ for long-running tasks:",
          "context": "_grievance(...):\n    ...\n```\n\n### 4. Background Task Queue\n\nUse Celery or RQ for long-running tasks:"
        },
        {
          "language": "bash",
          "code": "uvicorn main:app --workers 4\n   ```\n\n2. **Browser Pool**\n   - Pre-launch multiple browser instances\n   - Reuse connections\n\n3. **Caching**\n   - Cache municipality configs\n   - Cache generated scrapers in memory\n\n4. **Database**\n   - Store submissions in PostgreSQL\n   - Track status checks\n\n## \ud83d\udd10 Security\n\n### API Key Protection\n- Never commit `.env` to git\n- Use secrets management (Vault, AWS Secrets Manager)\n\n### Input Validation\n- Sanitize all user inputs\n- Validate phone numbers, emails\n- Limit file upload sizes\n\n### Rate Limiting\n- Implement per-IP rate limits\n- Use CAPTCHA for public endpoints\n\n## \ud83d\udcde WhatsApp Integration (Future)\n\nTo add WhatsApp interface:\n\n1. Use Twilio WhatsApp API\n2. Parse incoming messages\n3. Call `/api/submit` endpoint\n4. Reply with tracking ID",
          "description": "1. **Multiple Workers**",
          "context": "gic\n    pass\n```\n\n## \ud83d\udcc8 Scaling\n\n### For High Volume (1000+ submissions/day)\n\n1. **Multiple Workers**"
        }
      ],
      "patterns": [
        {
          "type": "example",
          "pattern": "** Learning 10 websites = $1.20 one-time"
        }
      ],
      "best_practices": [],
      "architecture_notes": [
        "\"address\": \"Main Road, Doranda, Ranchi\"\n    }\n  }'\n```",
        "\u2193\nSend to Claude Vision:\n  - Screenshot (base64)\n  - HTML snippet\n  - URL context\n       \u2193\nClaude analyzes and returns JSON:\n  {\n    \"form_fields\": [...],\n    \"submit_button\": {...},"
      ]
    },
    {
      "title": "Grivredr System Improvements - Implementation Complete",
      "file_path": "IMPROVEMENTS.md",
      "key_concepts": [
        "Grivredr System Improvements - Implementation Complete",
        "Executive Summary",
        "Key Achievements",
        "Phase 1: Execution Validation & Core Testing \u2705",
        "1.1 Scraper Execution Validation Pipeline",
        "`/home/sidhant/Desktop/grivredr/utils/scraper_validator.py` (300 lines)",
        "`/home/sidhant/Desktop/grivredr/utils/mock_manager.py` (200 lines)",
        "All Playwright operations are mocked",
        "`/home/sidhant/Desktop/grivredr/config/healing_prompts.py` (100 lines)",
        "In CodeGeneratorAgent",
        "1.2 Enhanced CodeGeneratorAgent",
        "1.3 Test Infrastructure",
        "`/home/sidhant/Desktop/grivredr/tests/conftest.py` (150 lines)",
        "`/home/sidhant/Desktop/grivredr/tests/unit/test_scraper_validator.py` (200 lines)",
        "`/home/sidhant/Desktop/grivredr/tests/unit/agents/test_code_generator_agent.py` (200 lines)",
        "`/home/sidhant/Desktop/grivredr/tests/integration/test_complete_workflow.py` (500 lines)",
        "1.4 CI/CD Pipeline",
        "Phase 2: JavaScript Analysis & Pattern Library \u2705",
        "2.1 JavaScript Runtime Monitoring",
        "2.2 Pattern Library",
        "Phase 3: Real-time Dashboard \u2705",
        "3.1 Flask Dashboard",
        "`/home/sidhant/Desktop/grivredr/dashboard/app.py` (150 lines)",
        "`/home/sidhant/Desktop/grivredr/dashboard/templates/index.html` (500+ lines)",
        "`/home/sidhant/Desktop/grivredr/dashboard/README.md`",
        "3.2 Orchestrator Integration",
        "Start dashboard first",
        "Terminal 1:",
        "Run training with dashboard enabled",
        "Terminal 2:",
        "Dashboard shows live progress, logs, and updates",
        "Phase 4: Enhanced AI Prompts \u2705",
        "4.1 Code Generation Prompt Enhancement",
        "Validation & Testing Scripts \u2705",
        "1. System Validator",
        "Output:",
        "================================================================================",
        "\ud83d\udd0d GRIVREDR SYSTEM VALIDATION",
        "================================================================================",
        "# CHECKING DEPENDENCIES",
        "\u2705 playwright          - Browser automation",
        "\u2705 flask               - Dashboard backend",
        "\u2705 flask_socketio      - Real-time updates",
        "\u2705 pytest              - Testing framework",
        "...",
        "# CHECKING COMPONENTS",
        "\u2705 agents/base_agent.py                     - Base agent with reflection",
        "\u2705 agents/code_generator_agent.py           - Code generation + validation",
        "...",
        "# RUNNING UNIT TESTS",
        "\u2705 All unit tests passed",
        "# RUNNING INTEGRATION TESTS",
        "\u2705 All integration tests passed",
        "# VALIDATION SUMMARY",
        "\u2705 Dependencies        : PASSED",
        "\u2705 Components          : PASSED",
        "\u2705 Unit Tests          : PASSED",
        "\u2705 Integration Tests   : PASSED",
        "# \ud83c\udf89 SYSTEM VALIDATION COMPLETE - ALL CHECKS PASSED!",
        "2. Ranchi E2E Test",
        "Run complete training",
        "Test existing scraper",
        "3. Test Documentation",
        "System Architecture After Improvements",
        "Files Summary",
        "New Files Created (16 files, ~6,150 lines)",
        "Modified Files (4 files)",
        "Next Steps (Optional, Not Yet Implemented)",
        "Phase 5: Health Monitoring & Auto-Retraining (2 weeks)",
        "Phase 6: Scale Optimizations (2 weeks)",
        "Phase 7: Testing & Validation (2 weeks)",
        "Success Metrics",
        "Current Status (After Phases 1-4)",
        "Next Milestones",
        "How to Use the Improved System",
        "1. Validate System Health",
        "2. Start Dashboard (Optional)",
        "Terminal 1",
        "Open http://localhost:5000",
        "3. Run Training",
        "Terminal 2",
        "Or via Python",
        "4. Monitor Progress",
        "5. Test Generated Scraper",
        "6. Check Metrics",
        "Cost Impact",
        "Before Improvements",
        "After Improvements",
        "Conclusion"
      ],
      "code_examples": [
        {
          "language": "python",
          "code": "async def validate_scraper(\n    self,\n    scraper_path: Path,\n    test_data: Dict[str, Any],\n    expected_schema: Optional[Dict] = None\n) -> ValidationResult:\n    \"\"\"\n    Validates scraper through:\n    1. Syntax validation (AST parsing)\n    2. Dynamic import\n    3. Test mode execution\n    4. Schema validation\n    5. Confidence scoring\n    \"\"\"",
          "description": "**Key Features**:",
          "context": " validation\n- **Returns**: `ValidationResult` dataclass with detailed diagnostics\n\n**Key Features**:"
        },
        {
          "language": "python",
          "code": "mock_mgr = MockManager()\nmock_context = mock_mgr.create_mock_browser_context()\n\n# All Playwright operations are mocked\nawait mock_context.goto(\"https://test.com\")  # Doesn't actually navigate\nawait mock_context.click(\"#submit\")  # Doesn't actually click",
          "description": "**Usage**:",
          "context": "hot`, `wait_for_selector`\n- **Tracking**: Captures all operations without real execution\n\n**Usage**:"
        },
        {
          "language": "python",
          "code": "# In CodeGeneratorAgent\nfor attempt in range(3):\n    validation_result = await validator.validate_scraper(scraper_path, test_data)\n\n    if validation_result.success:\n        break  # Success!\n    else:\n        # Ask AI to fix the code\n        scraper_code = await self._heal_scraper(\n            scraper_code,\n            validation_result,\n            schema_dict\n        )",
          "description": "**Self-Healing Loop**:",
          "context": "or-specific guidance\n  - `CONFIDENCE_ASSESSMENT_PROMPT` - Confidence scoring\n\n**Self-Healing Loop**:"
        },
        {
          "language": "python",
          "code": "validation_passed: bool = False\n   validation_attempts: int = 0\n   validation_errors: List[str] = field(default_factory=list)\n   confidence_score: float = 0.0\n   ```\n\n3. **New Methods**:\n   - `_heal_scraper()` - Sends validation errors to AI for fixing\n   - `_generate_test_data()` - Creates realistic test data from schema\n   - `_calculate_confidence()` - Computes confidence score (0.0-1.0)\n\n**Workflow**:",
          "description": "2. **New Fields in `GeneratedScraper`**:",
          "context": "f validation fails\n   - Returns detailed confidence scores\n\n2. **New Fields in `GeneratedScraper`**:"
        },
        {
          "language": "text",
          "code": "**Expected Impact**: Reduce production failures from 30-40% to 10-15%\n\n### 1.3 Test Infrastructure\n\n**Files Created**:\n\n#### `/home/sidhant/Desktop/grivredr/tests/conftest.py` (150 lines)\n- Shared pytest fixtures for all tests\n- **Fixtures**:\n  - `mock_ai_client` - Mocked AI responses\n  - `mock_playwright` - Mocked browser operations\n  - `sample_form_schema` - Standard test form\n  - `sample_test_data` - Standard test input\n  - `mock_validation_result_success` - Successful validation result\n  - `mock_validation_result_failure` - Failed validation result\n\n#### `/home/sidhant/Desktop/grivredr/tests/unit/test_scraper_validator.py` (200 lines)\n- Unit tests for `ScraperValidator`\n- **Tests**:\n  - Syntax validation (valid/invalid code)\n  - Schema validation (field types, required fields)\n  - Confidence scoring\n  - Error reporting\n\n#### `/home/sidhant/Desktop/grivredr/tests/unit/agents/test_code_generator_agent.py` (200 lines)\n- Unit tests for `CodeGeneratorAgent`\n- **Tests**:\n  - Test data generation\n  - Confidence calculation\n  - Syntax validation\n  - Self-healing loop\n\n#### `/home/sidhant/Desktop/grivredr/tests/integration/test_complete_workflow.py` (500 lines)\n- Integration tests for complete training workflow\n- **Tests**:\n  - Complete workflow with mocked AI\n  - Pattern library integration\n  - Self-healing workflow\n  - Dashboard integration\n  - JS monitoring integration\n\n### 1.4 CI/CD Pipeline\n\n**File Created**: `/home/sidhant/Desktop/grivredr/.github/workflows/test.yml` (80 lines)\n\n**Workflow**:\n1. **Linting**: Black, Flake8, MyPy\n2. **Unit Tests**: Fast tests with mocking\n3. **Integration Tests**: Component integration\n4. **Coverage**: Requires 70% minimum\n5. **Upload**: Coverage to Codecov\n\n**Triggers**:\n- Every push to `main`\n- Every pull request\n- Manual dispatch\n\n**Configuration**:",
          "description": "Save to Production",
          "context": "\n                    \u2193\n               [If Pass]\n                    \u2193\n            Save to Production"
        },
        {
          "language": "text",
          "code": "---\n\n## Phase 2: JavaScript Analysis & Pattern Library \u2705\n\n**Goal**: Capture dynamic behavior and learn from successful patterns\n\n### 2.1 JavaScript Runtime Monitoring\n\n**File Created**: `/home/sidhant/Desktop/grivredr/utils/js_runtime_monitor.py` (250 lines)\n\n**Key Class**: `JSRuntimeMonitor`\n\n**Capabilities**:\n1. **Injects Monitoring Script** into browser:\n   - Intercepts `XMLHttpRequest` (AJAX calls)\n   - Intercepts `fetch` (modern API calls)\n   - Observes `MutationObserver` (DOM changes)\n   - Tracks form events (submit, change, focus)\n\n2. **Captures Events**:\n   ```python\n   js_events = await monitor.capture_events(page, timeout=2)\n   # Returns list of captured events with timestamps\n   ```\n\n3. **Analyzes Behavior**:\n   ```python\n   analysis = monitor.analyze_events(js_events)\n   # Returns:\n   # - has_ajax: bool\n   # - has_dynamic_content: bool\n   # - ajax_endpoints: list[str]\n   # - cascading_dropdowns: list[dict]\n   # - dynamic_fields: list[str]\n   ```\n\n**Monitoring Script** (injected into browser):",
          "description": "--cov-fail-under=70",
          "context": " tests/unit/ tests/integration/ \\\n      --cov=. \\\n      --cov-report=xml \\\n      --cov-fail-under=70"
        },
        {
          "language": "text",
          "code": "**Integration with FormDiscoveryAgent**:\n\n**File Modified**: `/home/sidhant/Desktop/grivredr/agents/form_discovery_agent.py`\n\n**Changes**:\n1. Added `js_monitor: Optional[JSRuntimeMonitor]` field\n2. Added `enable_js_monitoring: bool = True` parameter\n3. Injects monitor during form exploration:\n   ```python\n   if self.js_monitor:\n       await self.js_monitor.inject_monitoring(page)\n       await self.js_monitor.interact_with_form(page)\n       self.js_events = await self.js_monitor.capture_events(page, timeout=2)\n   ```\n4. Includes JS analysis in discovery result\n\n**Expected Impact**: Catch 60-70% of dynamic form failures that vision-only analysis misses\n\n### 2.2 Pattern Library\n\n**File Created**: `/home/sidhant/Desktop/grivredr/knowledge/pattern_library.py` (400 lines)\n\n**Purpose**: Learn from successful scrapers to improve future generations\n\n**Key Class**: `PatternLibrary`\n\n**Database Schema** (SQLite):",
          "description": "observer.observe(document.body, {childList: true, subtree: true});",
          "context": "tion.type\n        });\n    });\n});\nobserver.observe(document.body, {childList: true, subtree: true});"
        },
        {
          "language": "text",
          "code": "**Key Methods**:\n\n1. **Store Pattern**:\n   ```python\n   def store_pattern(\n       self,\n       municipality_name: str,\n       form_schema: Dict[str, Any],\n       code_snippets: Dict[str, str],\n       confidence_score: float,\n       success_rate: float = 1.0\n   ):\n       \"\"\"Store successful scraper pattern\"\"\"\n   ```\n\n2. **Find Similar Patterns** (Jaccard Similarity):\n   ```python\n   def find_similar_patterns(\n       self,\n       form_schema: Dict[str, Any],\n       top_k: int = 3\n   ) -> List[ScraperPattern]:\n       \"\"\"\n       Find similar patterns using Jaccard similarity:\n       similarity = |A \u2229 B| / |A \u222a B|\n\n       Example:\n       Form A: [text, email, textarea, select]\n       Form B: [text, email, select, file]\n\n       Intersection: [text, email, select] = 3\n       Union: [text, email, textarea, select, file] = 5\n       Similarity: 3/5 = 0.6 (60% match)\n       \"\"\"\n   ```\n\n3. **Get Code Snippets**:\n   ```python\n   def get_recommended_code_snippets(\n       self,\n       form_context: Dict[str, Any]\n   ) -> Dict[str, str]:\n       \"\"\"\n       Returns reusable code snippets from similar forms:\n       - selector_patterns\n       - wait_strategies\n       - error_handling\n       - validation_logic\n       \"\"\"\n   ```\n\n**Integration with CodeGeneratorAgent**:\n\n**File Modified**: `/home/sidhant/Desktop/grivredr/agents/code_generator_agent.py`\n\n**Changes**:\n1. Added `pattern_library: PatternLibrary` field\n2. Before code generation:\n   ```python\n   # Find similar patterns\n   similar_patterns = self.pattern_library.find_similar_patterns(\n       schema_dict,\n       top_k=3\n   )\n\n   if similar_patterns:\n       context['similar_patterns'] = [\n           {\n               'municipality': p.municipality_name,\n               'similarity': similarity,\n               'code_snippets': p.code_snippets\n           }\n           for similarity, p in similar_patterns\n       ]\n   ```\n\n3. After successful validation:\n   ```python\n   # Store pattern for future use\n   self.pattern_library.store_pattern(\n       municipality_name=context['municipality'],\n       form_schema=schema_dict,\n       code_snippets=extract_code_snippets(scraper_code),\n       confidence_score=confidence_score,\n       success_rate=1.0\n   )\n   ```\n\n**Expected Impact**: Reduce training time by 60% after 10 municipalities through pattern reuse\n\n---\n\n## Phase 3: Real-time Dashboard \u2705\n\n**Goal**: Enable human oversight and intervention during training\n\n### 3.1 Flask Dashboard\n\n**Files Created**:\n\n#### `/home/sidhant/Desktop/grivredr/dashboard/app.py` (150 lines)\n\n**Framework**: Flask + Flask-SocketIO\n\n**Routes**:\n\n1. **`GET /`** - Dashboard home page\n2. **`GET /api/scrapers`** - List all generated scrapers\n3. **`GET /api/scraper/<scraper_id>`** - Scraper details and code\n4. **`GET /api/patterns`** - Pattern library statistics\n5. **`POST /api/training/start`** - Start training new municipality\n\n**WebSocket Events**:\n\n**Client \u2192 Server**:\n- `subscribe_training` - Subscribe to training updates\n- `unsubscribe_training` - Unsubscribe from updates\n\n**Server \u2192 Client**:\n- `training_update` - Real-time progress updates\n- `training_complete` - Training finished notification\n- `connection_established` - Initial connection\n\n**Helper Functions**:",
          "description": "CREATE INDEX idx_confidence ON patterns(confidence_score DESC);",
          "context": "gnature ON patterns(form_signature);\nCREATE INDEX idx_confidence ON patterns(confidence_score DESC);"
        },
        {
          "language": "text",
          "code": "#### `/home/sidhant/Desktop/grivredr/dashboard/templates/index.html` (500+ lines)\n\n**UI Features**:\n\n1. **Statistics Grid** (4 cards):\n   - Total Scrapers\n   - Patterns Learned\n   - Avg Confidence\n   - Success Rate\n\n2. **Scraper List**:\n   - Grid view of all generated scrapers\n   - Municipality name, creation date, status badge\n   - Actions: View code, test, deploy\n\n3. **Training Monitor** (WebSocket-powered):\n   - Real-time progress bar (0-100%)\n   - Current phase display\n   - Live log stream\n   - Auto-updates every 30 seconds\n\n4. **Connection Status**:\n   - Green dot: Connected\n   - Red dot: Disconnected\n   - Fixed position, top-right\n\n**Styling**:\n- Dark theme (`#0a0e27` background)\n- Gradient accents (`#667eea` \u2192 `#764ba2`)\n- Responsive grid layout\n- Smooth animations\n\n**JavaScript Client**:",
          "description": "}, room=session_id)",
          "context": "\n        'data': data or {},\n        'timestamp': datetime.now().isoformat()\n    }, room=session_id)"
        },
        {
          "language": "text",
          "code": "#### `/home/sidhant/Desktop/grivredr/dashboard/README.md`\n\nComplete documentation for:\n- Installation instructions\n- API endpoints with request/response examples\n- WebSocket events with JavaScript examples\n- Architecture overview\n- Technology stack\n- Next steps\n\n### 3.2 Orchestrator Integration\n\n**File Modified**: `/home/sidhant/Desktop/grivredr/agents/orchestrator.py`\n\n**Changes**:\n1. Added `dashboard_enabled: bool = False` parameter\n2. Import dashboard functions if enabled:\n   ```python\n   if dashboard_enabled:\n       try:\n           from dashboard.app import emit_training_update, emit_training_complete\n           self.emit_update = emit_training_update\n           self.emit_complete = emit_training_complete\n       except ImportError:\n           logger.warning(\"Dashboard not available\")\n           self.dashboard_enabled = False\n   ```\n\n3. Emit updates at each phase:\n   ```python\n   # Phase 1: Form Discovery (0-25%)\n   if self.dashboard_enabled:\n       self.emit_update(session_id, \"Form Discovery\", 0, \"Starting form discovery...\")\n\n   discovery_result = await self._run_form_discovery(...)\n\n   if self.dashboard_enabled:\n       self.emit_update(session_id, \"Form Discovery\", 25,\n           f\"Discovered {len(fields)} fields\")\n\n   # Phase 2: JavaScript Analysis (25-40%)\n   if self.dashboard_enabled:\n       self.emit_update(session_id, \"JavaScript Analysis\", 25,\n           \"Analyzing dynamic JavaScript behavior...\")\n\n   # ... and so on for phases 3, 4, 5\n   ```\n\n4. Emit completion:\n   ```python\n   if self.dashboard_enabled:\n       self.emit_complete(session_id, True, result)\n   ```\n\n**Progress Mapping**:\n- Phase 1 (Form Discovery): 0% \u2192 25%\n- Phase 2 (JavaScript Analysis): 25% \u2192 40%\n- Phase 3 (Test Validation): 40% \u2192 60%\n- Phase 4 (Code Generation): 60% \u2192 90%\n- Phase 5 (Finalize): 90% \u2192 100%\n\n**Usage**:",
          "description": "});",
          "context": "success) {\n        alert('\u2705 Training completed successfully!');\n        refreshScrapers();\n    }\n});"
        },
        {
          "language": "text",
          "code": "---\n\n## Phase 4: Enhanced AI Prompts \u2705\n\n**Goal**: Improve generated code quality through better prompting\n\n**File Modified**: `/home/sidhant/Desktop/grivredr/config/ai_client.py`\n\n### 4.1 Code Generation Prompt Enhancement\n\n**Changes to `generate_scraper_code()` method** (lines ~150-200):\n\n**Added Section**: **MANDATORY DEFENSIVE CODING PATTERNS**",
          "description": ")",
          "context": "xample.com/form\",\n    municipality=\"test_city\"\n)\n\n# Dashboard shows live progress, logs, and updates"
        },
        {
          "language": "python",
          "code": "# GOOD - Multiple fallback strategies:\n   element = await page.query_selector(\"#name\") or \\\n             await page.query_selector(\"[name='name']\") or \\\n             await page.query_selector(\"input[placeholder*='name' i]\")\n\n   # BAD - Single point of failure:\n   element = await page.query_selector(\"#name\")\n   ```\n\n5. **Test Mode Support:**\n   - Include async def run_test_mode(self, test_data: dict) -> dict\n   - In test mode: validate field presence but DON'T submit\n   - Return structured test results with field coverage\n\n6. **Structured Error Responses:**\n   ```python\n   return {{\n       \"success\": False,\n       \"error\": \"Could not find submit button\",\n       \"attempted_selectors\": [\"#submit\", \"button[type='submit']\"],\n       \"page_html\": page_html[:500],  # For debugging\n       \"screenshot\": screenshot_path\n   }}\n   ```\n\nGenerate a complete Python class that:\n1. Uses Playwright async API\n2. Handles navigation and waits intelligently with EXPLICIT WAITS\n3. Fills all identified form fields with FALLBACK SELECTORS\n4. Handles file uploads if present\n5. Submits the form and captures success/error messages\n6. Takes screenshots at each step for debugging\n7. Returns structured result (success, tracking_id, screenshots, errors)\n8. Has COMPREHENSIVE error handling and retries\n\nRequirements:\n- Class name: {municipality_name.title().replace(' ', '')}Scraper\n- Method: async def submit_grievance(self, data: dict) -> dict\n- Include: async def run_test_mode(self, test_data: dict) -> dict\n- Input data format: {{\"name\": \"...\", \"phone\": \"...\", \"complaint\": \"...\", \"category\": \"...\", \"file_path\": \"...\"}}\n- Use headless=False for debugging, make it configurable\n- Add stealth mode to avoid detection\n- Log all actions for debugging\n\nReturn ONLY the Python code, no explanations. Make it production-ready with DEFENSIVE patterns.\n\"\"\"",
          "description": "Every element interaction must have fallback selectors:",
          "context": "re proceeding\n\n4. **Selector Fallbacks:**\n   Every element interaction must have fallback selectors:"
        },
        {
          "language": "bash",
          "code": "python scripts/validate_system.py\n\n# Output:\n# ================================================================================\n# \ud83d\udd0d GRIVREDR SYSTEM VALIDATION\n# ================================================================================\n#\n# CHECKING DEPENDENCIES\n# \u2705 playwright          - Browser automation\n# \u2705 flask               - Dashboard backend\n# \u2705 flask_socketio      - Real-time updates\n# \u2705 pytest              - Testing framework\n# ...\n#\n# CHECKING COMPONENTS\n# \u2705 agents/base_agent.py                     - Base agent with reflection\n# \u2705 agents/code_generator_agent.py           - Code generation + validation\n# ...\n#\n# RUNNING UNIT TESTS\n# \u2705 All unit tests passed\n#\n# RUNNING INTEGRATION TESTS\n# \u2705 All integration tests passed\n#\n# VALIDATION SUMMARY\n# \u2705 Dependencies        : PASSED\n# \u2705 Components          : PASSED\n# \u2705 Unit Tests          : PASSED\n# \u2705 Integration Tests   : PASSED\n#\n# \ud83c\udf89 SYSTEM VALIDATION COMPLETE - ALL CHECKS PASSED!",
          "description": "**Usage**:",
          "context": " Tests**: Runs pytest unit tests\n4. **Integration Tests**: Runs pytest integration tests\n\n**Usage**:"
        },
        {
          "language": "bash",
          "code": "# Run complete training\npython scripts/test_ranchi.py\n\n# Test existing scraper\npython scripts/test_ranchi.py --test-scraper generated_scrapers/ranchi/ranchi_scraper.py",
          "description": "**Usage**:",
          "context": "erated scraper with dummy data\n   - Validates output schema\n   - Reports success/failure\n\n**Usage**:"
        },
        {
          "language": "text",
          "code": "\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                        GRIVREDR SYSTEM                          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                      USER INTERFACE LAYER                       \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  \u2022 Dashboard (Flask + SocketIO)                                 \u2502\n\u2502    - Real-time training monitor                                 \u2502\n\u2502    - Scraper management                                         \u2502\n\u2502    - Pattern library viewer                                     \u2502\n\u2502  \u2022 CLI (scripts/test_ranchi.py)                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                              \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    ORCHESTRATION LAYER                          \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  \u2022 Orchestrator                                                 \u2502\n\u2502    - Coordinates 5 phases                                       \u2502\n\u2502    - Manages human-in-loop                                      \u2502\n\u2502    - Emits WebSocket updates                                    \u2502\n\u2502    - Tracks costs and metrics                                   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                              \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                       AGENT LAYER                               \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  Phase 1: FormDiscoveryAgent                                    \u2502\n\u2502    - Vision analysis (screenshots)                              \u2502\n\u2502    - JS runtime monitoring \u2190 NEW                                \u2502\n\u2502    - Interactive form exploration                               \u2502\n\u2502                                                                 \u2502\n\u2502  Phase 2: JavaScriptAnalyzerAgent                               \u2502\n\u2502    - Dynamic behavior detection                                 \u2502\n\u2502    - AJAX endpoint discovery                                    \u2502\n\u2502    - Cascading dropdown detection                               \u2502\n\u2502                                                                 \u2502\n\u2502  Phase 3: TestValidationAgent                                   \u2502\n\u2502    - Schema validation                                          \u2502\n\u2502    - Field testing                                              \u2502\n\u2502    - Confidence scoring                                         \u2502\n\u2502                                                                 \u2502\n\u2502  Phase 4: CodeGeneratorAgent \u2190 ENHANCED                         \u2502\n\u2502    - Pattern library lookup \u2190 NEW                               \u2502\n\u2502    - Code generation (AI)                                       \u2502\n\u2502    - Execution validation \u2190 NEW                                 \u2502\n\u2502    - Self-healing loop (up to 3x) \u2190 NEW                         \u2502\n\u2502                                                                 \u2502\n\u2502  Phase 5: Finalization                                          \u2502\n\u2502    - Save scraper                                               \u2502\n\u2502    - Store pattern \u2190 NEW                                        \u2502\n\u2502    - Update metrics                                             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                              \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                      VALIDATION LAYER \u2190 NEW                     \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  \u2022 ScraperValidator                                             \u2502\n\u2502    - Syntax validation (AST)                                    \u2502\n\u2502    - Dynamic import                                             \u2502\n\u2502    - Test mode execution                                        \u2502\n\u2502    - Schema validation                                          \u2502\n\u2502    - Confidence scoring                                         \u2502\n\u2502                                                                 \u2502\n\u2502  \u2022 MockManager                                                  \u2502\n\u2502    - Prevents real submissions                                  \u2502\n\u2502    - Tracks operations                                          \u2502\n\u2502    - Safe testing environment                                   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                              \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    KNOWLEDGE LAYER \u2190 NEW                        \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  \u2022 PatternLibrary (SQLite)                                      \u2502\n\u2502    - Stores successful patterns                                 \u2502\n\u2502    - Jaccard similarity matching                                \u2502\n\u2502    - Code snippet recommendations                               \u2502\n\u2502    - Learning from past successes                               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                              \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    MONITORING LAYER \u2190 NEW                       \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  \u2022 JSRuntimeMonitor                                             \u2502\n\u2502    - Intercepts AJAX/fetch                                      \u2502\n\u2502    - Observes DOM mutations                                     \u2502\n\u2502    - Tracks form events                                         \u2502\n\u2502    - Analyzes dynamic behavior                                  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                              \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                       AI CLIENT LAYER                           \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  \u2022 AIClient (Claude via MegaLLM)                                \u2502\n\u2502    - Vision analysis (Sonnet) \u2190 ENHANCED PROMPTS                \u2502\n\u2502    - Code generation (Opus) \u2190 ENHANCED PROMPTS                  \u2502\n\u2502    - Self-healing (Sonnet)                                      \u2502\n\u2502    - Status extraction (Haiku)                                  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                              \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                        TEST LAYER \u2190 NEW                         \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  \u2022 Unit Tests (200+ tests)                                      \u2502\n\u2502    - Agent logic                                                \u2502\n\u2502    - Validation logic                                           \u2502\n\u2502    - Utility functions                                          \u2502\n\u2502                                                                 \u2502\n\u2502  \u2022 Integration Tests (50+ tests)                                \u2502\n\u2502    - Complete workflows                                         \u2502\n\u2502    - Component integration                                      \u2502\n\u2502    - Mocked AI/browser                                          \u2502\n\u2502                                                                 \u2502\n\u2502  \u2022 E2E Tests (~5 tests)                                         \u2502\n\u2502    - Real websites                                              \u2502\n\u2502    - Real AI calls                                              \u2502\n\u2502    - Full validation                                            \u2502\n\u2502                                                                 \u2502\n\u2502  \u2022 CI/CD (GitHub Actions)                                       \u2502\n\u2502    - Automated testing                                          \u2502\n\u2502    - Code coverage (70%+)                                       \u2502\n\u2502    - Linting & type checking                                    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518",
          "description": "---",
          "context": "ation\n- Coverage goals\n- Common issues and solutions\n\n---\n\n## System Architecture After Improvements"
        },
        {
          "language": "bash",
          "code": "python scripts/validate_system.py",
          "description": "---",
          "context": "ement caching and smart reuse\n\n---\n\n## How to Use the Improved System\n\n### 1. Validate System Health"
        },
        {
          "language": "bash",
          "code": "# Terminal 1\npython dashboard/app.py\n# Open http://localhost:5000",
          "description": "```",
          "context": "idate System Health\n```bash\npython scripts/validate_system.py\n```\n\n### 2. Start Dashboard (Optional)"
        },
        {
          "language": "bash",
          "code": "# Terminal 2\npython scripts/test_ranchi.py\n\n# Or via Python\nfrom agents.orchestrator import Orchestrator\n\norchestrator = Orchestrator(\n    headless=False,           # Show browser\n    dashboard_enabled=True    # Real-time updates\n)\n\nresult = await orchestrator.train_municipality(\n    url=\"https://smartranchi.in/Portal/View/ComplaintRegistration.aspx\",\n    municipality=\"ranchi\"\n)",
          "description": "```",
          "context": ")\n```bash\n# Terminal 1\npython dashboard/app.py\n# Open http://localhost:5000\n```\n\n### 3. Run Training"
        },
        {
          "language": "bash",
          "code": "python scripts/test_ranchi.py --test-scraper generated_scrapers/ranchi/ranchi_scraper.py",
          "description": "- **Pattern Library**: Check learned patterns",
          "context": "See detailed phase logs\n- **Pattern Library**: Check learned patterns\n\n### 5. Test Generated Scraper"
        },
        {
          "language": "python",
          "code": "cost_breakdown = orchestrator.get_cost_breakdown()\nprint(f\"Total cost: ${cost_breakdown['total_cost']:.4f}\")\n\npattern_stats = pattern_library.get_statistics()\nprint(f\"Total patterns: {pattern_stats['total_patterns']}\")",
          "description": "```",
          "context": "/test_ranchi.py --test-scraper generated_scrapers/ranchi/ranchi_scraper.py\n```\n\n### 6. Check Metrics"
        }
      ],
      "patterns": [
        {
          "type": "example",
          "pattern": "Form A: [text, email, textarea, select]"
        },
        {
          "type": "format",
          "pattern": "{{\"name\": \"...\", \"phone\": \"...\", \"complaint\": \"...\", \"category\": \"...\", \"file_path\": \"...\"}}"
        }
      ],
      "best_practices": [],
      "architecture_notes": [
        "**Status**: \u2705 Phases 1-4 Complete\n**Production Readiness**: 95% (up from 60%)",
        "| **Dynamic Behavior Detection** | Vision-only | Runtime JS monitoring | Catches 60-70% more edge cases |\n| **Learning Capability** | None | Pattern library w/ similarity matching | 60% time reduction after 10 municipalities |\n| **Monitoring** | CLI-only | Real-time dashboard | Live progress tracking |\n| **AI Prompt Quality** | Generic | Defensive coding requirements | Better generated code quality |",
        "```python\n   return {{\n       \"success\": False,\n       \"error\": \"Could not find submit button\",\n       \"attempted_selectors\": [\"#submit\", \"button[type='submit']\"],\n       \"page_html\": page_html[:500],  # For debugging\n       \"screenshot\": screenshot_path\n   }}\n   ```",
        "| **Dynamic Behavior Detection** | Yes | JS monitoring implemented | \u2705 Complete |\n| **Pattern Learning** | Yes | Pattern library implemented | \u2705 Complete |\n| **Real-time Monitoring** | Yes | Dashboard with WebSocket | \u2705 Complete |\n| **Code Quality** | High | Enhanced prompts | \u2705 Complete |",
        "- JavaScript runtime monitoring\n- Pattern library for learning\n- Real-time dashboard\n- Enhanced AI prompts"
      ]
    },
    {
      "title": "Phases 5, 6, 7 - Implementation Complete",
      "file_path": "PHASES_5_6_7_COMPLETE.md",
      "key_concepts": [
        "Phases 5, 6, 7 - Implementation Complete",
        "Phase 5: Health Monitoring & Auto-Retraining \u2705",
        "What Was Built",
        "1. Health Monitor (`monitoring/health_monitor.py` - 350 lines)",
        "Record execution",
        "Get health",
        "Get alerts",
        "Get retraining queue",
        "2. Alerting System (`monitoring/alerting.py` - 200 lines)",
        "Email",
        "Slack",
        "Custom Webhook",
        "Send alert",
        "Sends to all configured channels",
        "returns: {\"EmailAlertChannel\": True, \"SlackAlertChannel\": True}",
        "3. Production Scraper Runner (`scripts/run_scraper.py` - 300 lines)",
        "Run scraper in production",
        "Run in test mode (no submission)",
        "Disable monitoring",
        "Check health status",
        "Phase 6: Scale Optimizations \u2705",
        "What Was Built",
        "1. Batch Processor (`batch/batch_processor.py` - 300 lines)",
        "Define municipalities",
        "Create batch processor",
        "Process batch",
        "2. AI Call Caching (`utils/ai_cache.py` - 250 lines)",
        "Check cache",
        "Cache miss - make AI call",
        "Store in cache",
        "{",
        "\"total_entries\": 247,",
        "\"valid_entries\": 240,",
        "\"expired_entries\": 7,",
        "\"session_hits\": 98,",
        "\"session_misses\": 52,",
        "\"hit_rate\": 0.653  # 65.3% hit rate",
        "}",
        "{",
        "\"total_requests\": 150,",
        "\"cache_hits\": 98,",
        "\"cache_misses\": 52,",
        "\"hit_rate\": 0.653,",
        "\"cost_without_cache\": 7.50,  # $0.05 \u00d7 150",
        "\"cost_with_cache\": 2.60,     # $0.05 \u00d7 52",
        "\"savings\": 4.90,             # $4.90 saved",
        "\"savings_percentage\": 65.3   # 65.3% savings",
        "}",
        "3. AI Client Integration (`config/ai_client.py` - Modified)",
        "Phase 7: Testing & Validation \u2705",
        "What Was Built",
        "1. End-to-End Tests (`tests/e2e/test_complete_system.py` - 400 lines)",
        "Run all E2E tests",
        "Run specific test",
        "Skip slow tests",
        "2. Test Documentation (`tests/README.md` - Updated)",
        "System Architecture - Final State",
        "Complete File Manifest",
        "Phase 5 Files (3 new files, 850 lines)",
        "Phase 6 Files (2 new files, 1 modified, 550 lines)",
        "Phase 7 Files (1 new file, 400 lines)",
        "Grand Total (All Phases 1-7)",
        "Performance Metrics - Final",
        "Cost Analysis - Final",
        "Single Municipality",
        "Batch of 50 Municipalities",
        "Annual Costs (500 municipalities)",
        "Plus Monitoring Costs (minimal)",
        "How to Use the Complete System",
        "1. System Validation",
        "Validate all components work",
        "2. Train Single Municipality",
        "With dashboard",
        "Or programmatically",
        "3. Batch Processing",
        "4. Production Execution with Monitoring",
        "Run scraper with health tracking",
        "Check health status",
        "5. Monitor Health",
        "Get all scrapers health",
        "Get active alerts",
        "Get retraining queue",
        "6. Check Cache Savings",
        "7. Run Tests",
        "All tests",
        "Only E2E tests",
        "Skip slow tests",
        "With coverage",
        "Conclusion"
      ],
      "code_examples": [
        {
          "language": "sql",
          "code": "CREATE TABLE executions (\n    id INTEGER PRIMARY KEY,\n    scraper_id TEXT NOT NULL,\n    success BOOLEAN NOT NULL,\n    duration FLOAT NOT NULL,\n    error_type TEXT,\n    error_message TEXT,\n    timestamp DATETIME NOT NULL\n);\n\nCREATE TABLE alerts (\n    id INTEGER PRIMARY KEY,\n    scraper_id TEXT NOT NULL,\n    severity TEXT NOT NULL,  -- low, medium, high, critical\n    message TEXT NOT NULL,\n    action TEXT NOT NULL,     -- retrain, optimize, manual_review\n    created_at DATETIME NOT NULL,\n    resolved BOOLEAN DEFAULT 0\n);\n\nCREATE TABLE retraining_queue (\n    id INTEGER PRIMARY KEY,\n    scraper_id TEXT NOT NULL,\n    reason TEXT NOT NULL,\n    priority INTEGER DEFAULT 0,\n    status TEXT DEFAULT 'pending',\n    queued_at DATETIME DEFAULT CURRENT_TIMESTAMP\n);",
          "description": "**Database Schema** (SQLite):",
          "context": "raining Queue**: Automatically queues failing scrapers for retraining\n\n**Database Schema** (SQLite):"
        },
        {
          "language": "python",
          "code": "from monitoring.health_monitor import HealthMonitor\n\nmonitor = HealthMonitor()\n\n# Record execution\nmonitor.record_execution(\n    scraper_id=\"ranchi_scraper\",\n    success=True,\n    duration=5.2\n)\n\n# Get health\nhealth = monitor.get_scraper_health(\"ranchi_scraper\", window_hours=24)\nprint(f\"Success rate: {health.success_rate*100:.1f}%\")\nprint(f\"Health score: {health.health_score:.2f}\")\n\n# Get alerts\nalerts = monitor.get_active_alerts()\nfor alert in alerts:\n    print(f\"[{alert.severity.value}] {alert.message}\")\n\n# Get retraining queue\nqueue = monitor.get_retraining_queue()",
          "description": "**Usage**:",
          "context": "AL severity, immediate retraining\n- Avg execution time > 30s \u2192 MEDIUM severity, optimize\n\n**Usage**:"
        },
        {
          "language": "bash",
          "code": "# Email\nSMTP_HOST=smtp.gmail.com\nSMTP_PORT=587\nSMTP_USER=your@email.com\nSMTP_PASSWORD=your_password\nALERT_FROM_EMAIL=alerts@grivredr.com\nALERT_TO_EMAILS=admin@example.com,team@example.com\n\n# Slack\nSLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL\n\n# Custom Webhook\nALERT_WEBHOOK_URL=https://your-monitoring-system.com/alerts",
          "description": "**Configuration** (via environment variables):",
          "context": "lack** (Webhooks)\n3. **Custom Webhooks** (HTTP POST)\n\n**Configuration** (via environment variables):"
        },
        {
          "language": "python",
          "code": "from monitoring.alerting import AlertManager\nfrom monitoring.health_monitor import Alert, AlertSeverity\n\nmanager = AlertManager()\n\n# Send alert\nalert = Alert(\n    id=1,\n    scraper_id=\"ranchi_scraper\",\n    severity=AlertSeverity.HIGH,\n    message=\"Success rate dropped to 65%\",\n    action=\"retrain\",\n    created_at=datetime.now()\n)\n\n# Sends to all configured channels\nresults = manager.send_alert(alert, health=health)\n# returns: {\"EmailAlertChannel\": True, \"SlackAlertChannel\": True}",
          "description": "**Usage**:",
          "context": "OK/URL\n\n# Custom Webhook\nALERT_WEBHOOK_URL=https://your-monitoring-system.com/alerts\n```\n\n**Usage**:"
        },
        {
          "language": "bash",
          "code": "# Run scraper in production\npython scripts/run_scraper.py generated_scrapers/ranchi/ranchi_scraper.py \\\n    --data '{\"name\":\"Test\",\"email\":\"test@example.com\"}'\n\n# Run in test mode (no submission)\npython scripts/run_scraper.py generated_scrapers/ranchi/ranchi_scraper.py --test\n\n# Disable monitoring\npython scripts/run_scraper.py generated_scrapers/ranchi/ranchi_scraper.py --no-monitoring\n\n# Check health status\npython scripts/run_scraper.py generated_scrapers/ranchi/ranchi_scraper.py --health",
          "description": "**Usage**:",
          "context": "onitoring\n- Automatic alerting on failures\n- Test mode support\n- Health status reporting\n\n**Usage**:"
        },
        {
          "language": "text",
          "code": "================================================================================\nRUNNING SCRAPER\n================================================================================\nScraper: generated_scrapers/ranchi/ranchi_scraper.py\nMode: Production\nMonitoring: Enabled\nAlerting: Enabled\n================================================================================\n\n\u2705 SUCCESS\n\nDetails:\n  success: True\n  tracking_id: GRV123456\n  message: Complaint submitted successfully\n\nMonitoring:\n  scraper_id: ranchi_scraper\n  duration: 5.23\n  success: True\n  timestamp: 2024-12-24T10:30:00\n\nHEALTH STATUS\n================================================================================\n  scraper_id: ranchi_scraper\n  total_executions: 47\n  success_rate: 95.7%\n  health_score: 0.92\n  consecutive_failures: 0\n  needs_attention: False\n  avg_duration: 5.12s\n================================================================================",
          "description": "**Output**:",
          "context": "\npython scripts/run_scraper.py generated_scrapers/ranchi/ranchi_scraper.py --health\n```\n\n**Output**:"
        },
        {
          "language": "python",
          "code": "from batch.batch_processor import BatchProcessor\n\n# Define municipalities\nmunicipalities = [\n    {\n        \"municipality\": \"ranchi\",\n        \"url\": \"https://smartranchi.in/Portal/View/ComplaintRegistration.aspx\",\n        \"priority\": 1\n    },\n    {\n        \"municipality\": \"patna\",\n        \"url\": \"https://patna.gov.in/grievance\",\n        \"priority\": 0\n    },\n    # ... up to 50+ municipalities\n]\n\n# Create batch processor\nprocessor = BatchProcessor(\n    max_concurrent=5,        # Process 5 at a time\n    headless=True,\n    retry_failed=True,\n    max_retries=2\n)\n\n# Process batch\nresult = await processor.process_batch(\n    municipalities,\n    batch_name=\"maharashtra_batch\"\n)\n\nprint(f\"Success rate: {result['success_rate']*100:.1f}%\")\nprint(f\"Total cost: ${result['total_cost']:.2f}\")",
          "description": "**Usage**:",
          "context": "ng**: Real-time progress reporting\n- **Result Aggregation**: Comprehensive batch summary\n\n**Usage**:"
        },
        {
          "language": "text",
          "code": "================================================================================\nBATCH PROCESSING: maharashtra_batch\n================================================================================\nTotal municipalities: 50\nMax concurrent: 5\nHeadless mode: True\n================================================================================\n\n\ud83d\udd04 [maharashtra_batch_1] Starting: ranchi\n   URL: https://smartranchi.in/...\n   Attempt: 1/3\n   Progress: 0/50\n\n\u2705 [maharashtra_batch_1] Completed: ranchi\n   Cost: $0.82\n   Scraper: generated_scrapers/ranchi/ranchi_scraper.py\n\n...\n\n================================================================================\nBATCH PROCESSING COMPLETE\n================================================================================\nTotal Jobs: 50\n\u2705 Completed: 45\n\u274c Failed: 5\n\ud83d\udcca Success Rate: 90.0%\n\u23f1\ufe0f  Duration: 2847.3s (47.5 minutes)\n\u26a1 Avg Time per Job: 63.3s\n\n\u274c Failed Jobs:\n   - patna: TimeoutError: Page load timeout\n   - gaya: ValidationError: Submit button not found\n================================================================================\n\n\ud83d\udcbe Batch results saved: batch_results/maharashtra_batch.json",
          "description": "**Output**:",
          "context": "esult['success_rate']*100:.1f}%\")\nprint(f\"Total cost: ${result['total_cost']:.2f}\")\n```\n\n**Output**:"
        },
        {
          "language": "json",
          "code": "{\n  \"batch_name\": \"maharashtra_batch\",\n  \"total_jobs\": 50,\n  \"completed\": 45,\n  \"failed\": 5,\n  \"success_rate\": 0.9,\n  \"duration\": 2847.3,\n  \"total_cost\": 37.80,\n  \"start_time\": \"2024-12-24 09:00:00\",\n  \"end_time\": \"2024-12-24 09:47:27\",\n  \"jobs\": [\n    {\n      \"job_id\": \"maharashtra_batch_1\",\n      \"municipality\": \"ranchi\",\n      \"url\": \"https://smartranchi.in/...\",\n      \"status\": \"completed\",\n      \"scraper_path\": \"generated_scrapers/ranchi/ranchi_scraper.py\",\n      \"total_cost\": 0.82,\n      \"duration\": 63.2\n    }\n  ]\n}",
          "description": "**Batch Result JSON**:",
          "context": "===========\n\n\ud83d\udcbe Batch results saved: batch_results/maharashtra_batch.json\n```\n\n**Batch Result JSON**:"
        },
        {
          "language": "text",
          "code": "1. Generate cache key: SHA256(prompt + model + image_hash)\n2. Check cache: SELECT response WHERE cache_key = ?\n3. If hit: Return cached response (save $0.05)\n4. If miss: Call AI API \u2192 Cache response \u2192 Return",
          "description": "**How It Works**:",
          "context": "atistics\n- **Cost savings estimation**\n- **Automatic cleanup** of expired entries\n\n**How It Works**:"
        },
        {
          "language": "python",
          "code": "cache_key = SHA256(\n    model_name +\n    prompt_text +\n    image_data[:1000]  # First 1000 chars of image\n)",
          "description": "**Cache Key Generation**:",
          "context": "sponse (save $0.05)\n4. If miss: Call AI API \u2192 Cache response \u2192 Return\n```\n\n**Cache Key Generation**:"
        },
        {
          "language": "python",
          "code": "from utils.ai_cache import AICache\n\ncache = AICache(default_ttl_hours=24)\n\n# Check cache\ncached = cache.get(\n    prompt=\"Analyze this form...\",\n    model=\"claude-sonnet-4\",\n    image_data=screenshot_base64\n)\n\nif cached:\n    return cached  # Cache hit! Saved $0.05\n\n# Cache miss - make AI call\nresponse = ai_client.analyze(prompt, image)\n\n# Store in cache\ncache.set(\n    prompt=prompt,\n    model=\"claude-sonnet-4\",\n    response=response,\n    ttl_hours=24,\n    image_data=screenshot_base64\n)",
          "description": "**Usage**:",
          "context": " model_name +\n    prompt_text +\n    image_data[:1000]  # First 1000 chars of image\n)\n```\n\n**Usage**:"
        },
        {
          "language": "python",
          "code": "stats = cache.get_stats()\n# {\n#   \"total_entries\": 247,\n#   \"valid_entries\": 240,\n#   \"expired_entries\": 7,\n#   \"session_hits\": 98,\n#   \"session_misses\": 52,\n#   \"hit_rate\": 0.653  # 65.3% hit rate\n# }\n\nsavings = cache.estimate_cost_savings(avg_cost_per_call=0.05)\n# {\n#   \"total_requests\": 150,\n#   \"cache_hits\": 98,\n#   \"cache_misses\": 52,\n#   \"hit_rate\": 0.653,\n#   \"cost_without_cache\": 7.50,  # $0.05 \u00d7 150\n#   \"cost_with_cache\": 2.60,     # $0.05 \u00d7 52\n#   \"savings\": 4.90,             # $4.90 saved\n#   \"savings_percentage\": 65.3   # 65.3% savings\n# }",
          "description": "**Statistics**:",
          "context": "4\",\n    response=response,\n    ttl_hours=24,\n    image_data=screenshot_base64\n)\n```\n\n**Statistics**:"
        },
        {
          "language": "python",
          "code": "def analyze_website_structure(self, screenshot_base64: str, url: str):\n    # Extract prompt\n    prompt = f\"Analyze this grievance form...\"\n\n    # Check cache first\n    if self.cache:\n        cached_response = self.cache.get(\n            prompt=prompt,\n            model=self.models[\"balanced\"],\n            image_data=screenshot_base64\n        )\n        if cached_response:\n            return cached_response  # Cache hit!\n\n    # Cache miss - make AI call\n    response = self.client.chat.completions.create(...)\n    result = response.choices[0].message.content\n\n    # Store in cache\n    if self.cache:\n        self.cache.set(\n            prompt=prompt,\n            model=self.models[\"balanced\"],\n            response=result,\n            ttl_hours=24,\n            image_data=screenshot_base64\n        )\n\n    return result",
          "description": "**Cache Integration Example**:",
          "context": " AI methods\n3. Added `get_cache_stats()` and `clear_cache()` methods\n\n**Cache Integration Example**:"
        },
        {
          "language": "bash",
          "code": "# Run all E2E tests\npytest tests/e2e/ -v\n\n# Run specific test\npytest tests/e2e/test_complete_system.py::test_pattern_library_learning -v\n\n# Skip slow tests\npytest tests/e2e/ -m \"not slow\"",
          "description": "**Running E2E Tests**:",
          "context": "`**\n   - Verifies all critical files exist\n   - Checks no missing components\n\n**Running E2E Tests**:"
        },
        {
          "language": "text",
          "code": "\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                      PRODUCTION SYSTEM                          \u2502\n\u2502                  Grivredr - 100% Complete                       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\nUSER INTERFACE LAYER\n\u251c\u2500\u2500 Dashboard (Flask + SocketIO) \u2190 Real-time updates\n\u251c\u2500\u2500 CLI (scripts/test_ranchi.py) \u2190 Training & testing\n\u2514\u2500\u2500 Production Runner (scripts/run_scraper.py) \u2190 Monitored execution\n\nORCHESTRATION LAYER\n\u251c\u2500\u2500 Orchestrator \u2190 Coordinates all phases\n\u251c\u2500\u2500 Batch Processor \u2190 NEW: Parallel processing (5-10x faster)\n\u2514\u2500\u2500 Health Monitor \u2190 NEW: Automatic health tracking & alerts\n\nAGENT LAYER (5 Specialized Agents)\n\u251c\u2500\u2500 Phase 1: FormDiscoveryAgent + JS Monitoring\n\u251c\u2500\u2500 Phase 2: JavaScriptAnalyzerAgent\n\u251c\u2500\u2500 Phase 3: TestValidationAgent\n\u251c\u2500\u2500 Phase 4: CodeGeneratorAgent + Validation + Self-Healing\n\u2514\u2500\u2500 Phase 5: Finalization + Pattern Storage\n\nVALIDATION LAYER\n\u251c\u2500\u2500 ScraperValidator \u2190 Tests before production\n\u251c\u2500\u2500 MockManager \u2190 Safe testing environment\n\u2514\u2500\u2500 Self-Healing Loop \u2190 AI-powered fixes (up to 3 attempts)\n\nKNOWLEDGE LAYER\n\u251c\u2500\u2500 PatternLibrary \u2190 Learns from successes (60% time reduction)\n\u2514\u2500\u2500 AI Cache \u2190 NEW: 40% cost savings\n\nMONITORING LAYER \u2190 NEW\n\u251c\u2500\u2500 HealthMonitor \u2190 Execution tracking, alerts, retraining queue\n\u251c\u2500\u2500 AlertManager \u2190 Email, Slack, Webhook notifications\n\u2514\u2500\u2500 JSRuntimeMonitor \u2190 Dynamic behavior capture\n\nAI CLIENT LAYER\n\u251c\u2500\u2500 AIClient (Claude via MegaLLM)\n\u251c\u2500\u2500 AI Cache Integration \u2190 NEW: Automatic caching\n\u2514\u2500\u2500 Enhanced Prompts \u2190 Defensive coding patterns\n\nTEST LAYER\n\u251c\u2500\u2500 Unit Tests (200+ tests)\n\u251c\u2500\u2500 Integration Tests (50+ tests)\n\u251c\u2500\u2500 E2E Tests (8+ tests) \u2190 NEW: Complete system validation\n\u2514\u2500\u2500 CI/CD (GitHub Actions) \u2190 Automated testing + coverage\n\nOPTIMIZATION LAYER \u2190 NEW\n\u251c\u2500\u2500 Batch Processing \u2190 Parallel execution\n\u251c\u2500\u2500 AI Caching \u2190 Cost optimization\n\u2514\u2500\u2500 Resource Pooling \u2190 Efficient resource management",
          "description": "---",
          "context": "unning slow tests\n- Cost implications\n- CI/CD integration\n\n---\n\n## System Architecture - Final State"
        },
        {
          "language": "bash",
          "code": "# Validate all components work\npython scripts/validate_system.py",
          "description": "---",
          "context": "*Total additional cost: $0/month**\n\n---\n\n## How to Use the Complete System\n\n### 1. System Validation"
        },
        {
          "language": "bash",
          "code": "# With dashboard\npython scripts/test_ranchi.py\n\n# Or programmatically\nfrom agents.orchestrator import Orchestrator\n\norchestrator = Orchestrator(\n    headless=False,\n    dashboard_enabled=True\n)\n\nresult = await orchestrator.train_municipality(\n    url=\"https://smartranchi.in/...\",\n    municipality=\"ranchi\"\n)",
          "description": "```",
          "context": "Validate all components work\npython scripts/validate_system.py\n```\n\n### 2. Train Single Municipality"
        },
        {
          "language": "python",
          "code": "from batch.batch_processor import BatchProcessor\n\nmunicipalities = [\n    {\"municipality\": \"city1\", \"url\": \"...\", \"priority\": 1},\n    {\"municipality\": \"city2\", \"url\": \"...\", \"priority\": 0},\n    # ... up to 50+\n]\n\nprocessor = BatchProcessor(max_concurrent=5)\nresult = await processor.process_batch(municipalities)",
          "description": "```",
          "context": "lity(\n    url=\"https://smartranchi.in/...\",\n    municipality=\"ranchi\"\n)\n```\n\n### 3. Batch Processing"
        },
        {
          "language": "bash",
          "code": "# Run scraper with health tracking\npython scripts/run_scraper.py \\\n    generated_scrapers/ranchi/ranchi_scraper.py \\\n    --data complaint_data.json\n\n# Check health status\npython scripts/run_scraper.py \\\n    generated_scrapers/ranchi/ranchi_scraper.py \\\n    --health",
          "description": "```",
          "context": "ult = await processor.process_batch(municipalities)\n```\n\n### 4. Production Execution with Monitoring"
        },
        {
          "language": "python",
          "code": "from monitoring.health_monitor import HealthMonitor\n\nmonitor = HealthMonitor()\n\n# Get all scrapers health\nhealth_list = monitor.get_all_scrapers_health(window_hours=24)\nfor health in health_list:\n    print(f\"{health.scraper_id}: {health.success_rate*100:.1f}% ({health.health_score:.2f})\")\n\n# Get active alerts\nalerts = monitor.get_active_alerts()\nfor alert in alerts:\n    print(f\"[{alert.severity.value}] {alert.scraper_id}: {alert.message}\")\n\n# Get retraining queue\nqueue = monitor.get_retraining_queue()\nfor job in queue:\n    print(f\"Priority {job['priority']}: {job['scraper_id']}\")",
          "description": "```",
          "context": "raper.py \\\n    generated_scrapers/ranchi/ranchi_scraper.py \\\n    --health\n```\n\n### 5. Monitor Health"
        },
        {
          "language": "python",
          "code": "from config.ai_client import ai_client\n\nstats = ai_client.get_cache_stats()\nprint(f\"Hit rate: {stats['hit_rate']*100:.1f}%\")\nprint(f\"Savings: ${stats['cost_savings']['savings']:.2f}\")",
          "description": "```",
          "context": "queue:\n    print(f\"Priority {job['priority']}: {job['scraper_id']}\")\n```\n\n### 6. Check Cache Savings"
        },
        {
          "language": "bash",
          "code": "# All tests\npytest\n\n# Only E2E tests\npytest tests/e2e/ -v\n\n# Skip slow tests\npytest -m \"not slow\"\n\n# With coverage\npytest --cov=. --cov-report=html",
          "description": "```",
          "context": "_rate']*100:.1f}%\")\nprint(f\"Savings: ${stats['cost_savings']['savings']:.2f}\")\n```\n\n### 7. Run Tests"
        }
      ],
      "patterns": [],
      "best_practices": [],
      "architecture_notes": [
        "# Extract prompt\n    prompt = f\"Analyze this grievance form...\"",
        "- Verifies progress tracking\n   - Checks result aggregation",
        "- Verifies all required directories exist\n   - Checks project structure is correct",
        "- Verifies all critical files exist\n   - Checks no missing components",
        "| **Dynamic Behavior Detection** | Vision-only | JS monitoring | +70% edge cases |\n| **Learning** | None | Pattern library | 60% time reduction |\n| **Monitoring** | None | Real-time health tracking | 90% downtime reduction |\n| **Cost per Municipality** | $0.80 | $0.48 (with cache) | 40% savings |\n| **Batch Processing** | Sequential | 5-10x parallel | 80% time savings |\n| **Alerting** | None | Email + Slack + Webhook | Proactive detection |\n| **Production Readiness** | 60% | **100%** | Ready for "
      ]
    },
    {
      "title": "\ud83d\ude80 Quick Start Guide",
      "file_path": "QUICK_START.md",
      "key_concepts": [
        "\ud83d\ude80 Quick Start Guide",
        "Get Running in 5 Minutes",
        "Step 1: Install Dependencies (2 minutes)",
        "Install Python packages",
        "Install Playwright browser",
        "Step 2: Verify AI Connection (30 seconds)",
        "Step 3: Train on Smart Ranchi (3-5 minutes)",
        "Step 4: Test Generated Scraper (1 minute)",
        "View the generated code",
        "Run the tests",
        "\ud83c\udfaf What You Just Built",
        "\ud83d\udca1 Next Steps",
        "Use the Scraper",
        "Train More Municipalities",
        "Jharkhand state portal",
        "Ranchi main website",
        "Custom municipality",
        "Review Training Session",
        "View session details",
        "Check screenshots",
        "\ud83d\udc1b Troubleshooting",
        "\"Playwright not found\"",
        "\"API key error\"",
        "\"Low confidence score\"",
        "\"Tests failing\"",
        "\ud83d\udcd6 Learn More",
        "\ud83c\udf89 You're Done!"
      ],
      "code_examples": [
        {
          "language": "bash",
          "code": "cd /home/sidhant/Desktop/grivredr\n\n# Install Python packages\npip install -r requirements.txt\n\n# Install Playwright browser\nplaywright install chromium",
          "description": "",
          "context": "# \ud83d\ude80 Quick Start Guide\n\n## Get Running in 5 Minutes\n\n### Step 1: Install Dependencies (2 minutes)"
        },
        {
          "language": "bash",
          "code": "python test_ai_client.py",
          "description": "```",
          "context": "ll Playwright browser\nplaywright install chromium\n```\n\n### Step 2: Verify AI Connection (30 seconds)"
        },
        {
          "language": "text",
          "code": "\u2705 Success! Response: Hello from Claude!",
          "description": "Expected output:",
          "context": "### Step 2: Verify AI Connection (30 seconds)\n```bash\npython test_ai_client.py\n```\n\nExpected output:"
        },
        {
          "language": "bash",
          "code": "python train_cli.py ranchi_smart",
          "description": "```",
          "context": "ut:\n```\n\u2705 Success! Response: Hello from Claude!\n```\n\n### Step 3: Train on Smart Ranchi (3-5 minutes)"
        },
        {
          "language": "text",
          "code": "\u2705 TRAINING SUCCESSFUL!\nSession ID: ranchi_smart_20241223_143022\nScraper: generated_scrapers/ranchi_smart/ranchi_smart_scraper.py\nTotal Cost: $0.85\nHuman Interventions: 0",
          "description": "**Expected output**:",
          "context": "ucture\n5. Tests submission\n6. Generates Python scraper\n7. Shows cost breakdown\n\n**Expected output**:"
        },
        {
          "language": "bash",
          "code": "# View the generated code\ncat generated_scrapers/ranchi_smart/ranchi_smart_scraper.py\n\n# Run the tests\ncd generated_scrapers/ranchi_smart\npytest tests/ -v",
          "description": "```",
          "context": "raper.py\nTotal Cost: $0.85\nHuman Interventions: 0\n```\n\n### Step 4: Test Generated Scraper (1 minute)"
        },
        {
          "language": "python",
          "code": "import asyncio\nfrom generated_scrapers.ranchi_smart.ranchi_smart_scraper import RanchiSmartScraper\n\nasync def submit():\n    scraper = RanchiSmartScraper(headless=True)\n\n    result = await scraper.submit_grievance({\n        \"mobile\": \"9876543210\",\n        \"email\": \"user@example.com\",\n        \"select_type\": \"Street Lights\",\n        \"problem\": \"Not working\",\n        \"address\": \"Sector 5, Ranchi\",\n        \"remarks\": \"Street light near my house has been broken for 2 weeks\"\n    })\n\n    if result[\"success\"]:\n        print(f\"\u2705 Submitted! Tracking ID: {result['tracking_id']}\")\n    else:\n        print(f\"\u274c Failed: {result['message']}\")\n\nasyncio.run(submit())",
          "description": "---",
          "context": "\u2705 Take debug screenshots\n- \u2705 Run forever without AI costs\n\n---\n\n## \ud83d\udca1 Next Steps\n\n### Use the Scraper"
        },
        {
          "language": "bash",
          "code": "# Jharkhand state portal\npython train_cli.py jharkhand_state\n\n# Ranchi main website\npython train_cli.py ranchi_main\n\n# Custom municipality\npython train_cli.py patna https://patna.gov.in/complaints",
          "description": "```",
          "context": "   print(f\"\u274c Failed: {result['message']}\")\n\nasyncio.run(submit())\n```\n\n### Train More Municipalities"
        },
        {
          "language": "bash",
          "code": "# View session details\ncat training_sessions/ranchi_smart_20241223_143022.json\n\n# Check screenshots\nls dashboard/static/screenshots/",
          "description": "```",
          "context": "icipality\npython train_cli.py patna https://patna.gov.in/complaints\n```\n\n### Review Training Session"
        },
        {
          "language": "bash",
          "code": "playwright install chromium",
          "description": "---",
          "context": "eenshots\nls dashboard/static/screenshots/\n```\n\n---\n\n## \ud83d\udc1b Troubleshooting\n\n### \"Playwright not found\""
        }
      ],
      "patterns": [],
      "best_practices": [],
      "architecture_notes": [
        "5. Tests submission\n6. Generates Python scraper\n7. Shows cost breakdown",
        "- **How Agents Work**: Read `AGENTIC_EXAMPLE.md`\n- **Project Status**: Read `PROJECT_STATUS.md`\n- **Code**: Explore `agents/` directory"
      ]
    },
    {
      "title": "Agentic Training Example: Smart Ranchi Form",
      "file_path": "AGENTIC_EXAMPLE.md",
      "key_concepts": [
        "Agentic Training Example: Smart Ranchi Form",
        "\ud83c\udfac Live Training Session Walkthrough",
        "Initial State",
        "\ud83e\udd16 Agent Training Log",
        "Attempt #1: Initial Exploration",
        "Attempt #2: Interactive Discovery",
        "Attempt #3: Validation Discovery",
        "Attempt #4: Field Discovery Missed Fields",
        "Attempt #5: JavaScript Analysis",
        "Attempt #6: Human Review"
      ],
      "code_examples": [
        {
          "language": "text",
          "code": "URL: https://smartranchi.in/Portal/View/ComplaintRegistration.aspx?m=Online\nMunicipality: Ranchi\nTraining Status: Not Started\nHuman: Sidhant (supervising)",
          "description": "",
          "context": "entic Training Example: Smart Ranchi Form\n\n## \ud83c\udfac Live Training Session Walkthrough\n\n### Initial State"
        },
        {
          "language": "text",
          "code": "Action: Navigate to URL\nStatus: \u2705 Page loaded\n\nAction: Take screenshot for Claude Vision\nStatus: \u2705 Screenshot captured\n\nAction: Analyzing with Claude Vision...",
          "description": "**[FormDiscoveryAgent]** Starting exploration...",
          "context": " Training Log\n\n### Attempt #1: Initial Exploration\n\n**[FormDiscoveryAgent]** Starting exploration..."
        },
        {
          "language": "json",
          "code": "{\n  \"form_title\": \"Register Your Complaint\",\n  \"sections\": [\n    {\n      \"section\": \"Complainant Details\",\n      \"fields\": [\n        {\"label\": \"Problem\", \"type\": \"text\", \"selector\": \"#problem\", \"required\": true},\n        {\"label\": \"Select Type\", \"type\": \"dropdown\", \"selector\": \"#type\", \"required\": false},\n        {\"label\": \"Mobile No\", \"type\": \"text\", \"selector\": \"#mobile\", \"required\": true},\n        {\"label\": \"Email ID\", \"type\": \"text\", \"selector\": \"#email\", \"required\": false},\n        {\"label\": \"Residential Address\", \"type\": \"textarea\", \"selector\": \"#address\", \"required\": false},\n        {\"label\": \"Remarks\", \"type\": \"textarea\", \"selector\": \"#remarks\", \"required\": false}\n      ]\n    },\n    {\n      \"section\": \"Upload Document / Image\",\n      \"fields\": [\n        {\"label\": \"Select File Type\", \"type\": \"dropdown\", \"selector\": \"#filetype\", \"required\": false},\n        {\"label\": \"File Upload\", \"type\": \"file\", \"selector\": \"#fileupload\", \"required\": false}\n      ]\n    }\n  ],\n  \"submit_button\": {\"text\": \"Register Complaint\", \"selector\": \"button[type='submit']\"}\n}",
          "description": "**[Claude Vision Response]**",
          "context": "us: \u2705 Screenshot captured\n\nAction: Analyzing with Claude Vision...\n```\n\n**[Claude Vision Response]**"
        },
        {
          "language": "text",
          "code": "Action: Click \"Select Type\" dropdown\nResult: \u274c Dropdown appears empty in HTML but...\n\nAction: Trigger 'click' event\nResult: \u2705 Options appeared dynamically!\n\nDiscovered Options:\n  - Electrical\n  - Water Supply\n  - Roads\n  - Sanitation\n  - Street Lights\n  - Others\n\nAnalysis: This dropdown is populated by JavaScript on click.",
          "description": "**[FormDiscoveryAgent]** Testing dropdown interactions...",
          "context": "--\n\n### Attempt #2: Interactive Discovery\n\n**[FormDiscoveryAgent]** Testing dropdown interactions..."
        },
        {
          "language": "text",
          "code": "Action: Inspect \"Problem\" field more carefully\nResult: \u2705 It's actually a dropdown that depends on \"Select Type\"!\n\nDiscovery: \"Problem\" dropdown is populated based on \"Select Type\" selection\n- This is a cascading dropdown pattern\n- \"Problem\" won't populate until \"Select Type\" is chosen",
          "description": "**[FormDiscoveryAgent]** \ud83e\udd14 There's a \"Problem\" field but it looks like a dropdown, not text input. Let me recheck...",
          "context": "Agent]** \ud83e\udd14 There's a \"Problem\" field but it looks like a dropdown, not text input. Let me recheck..."
        },
        {
          "language": "text",
          "code": "Test: Submit form with all fields empty\nAction: Click \"Register Complaint\"\n\nResult: \u274c Validation errors appeared\n\nCaptured Errors:\n  - \"Please enter Mobile No.\"\n  - \"Please Select Type\"\n  - \"Please select Problem\"\n\nAnalysis:\n  \u2705 Mobile is required (confirmed)\n  \u2705 Select Type is required (Vision missed this!)\n  \u2705 Problem is required (Vision thought it was optional)",
          "description": "**[TestAgent]** Now let me test what's actually required...",
          "context": "-\n\n### Attempt #3: Validation Discovery\n\n**[TestAgent]** Now let me test what's actually required..."
        },
        {
          "language": "text",
          "code": "Test: Submit with main fields filled but Contact Person empty\nResult: \u2705 Form accepted\n\nConclusion: Contact Person fields are optional",
          "description": "**[FormDiscoveryAgent]** \ud83e\udd14 I noticed \"Contact Person No\" and \"Contact Person Name\" fields. Let me check if they're required...",
          "context": " I noticed \"Contact Person No\" and \"Contact Person Name\" fields. Let me check if they're required..."
        },
        {
          "language": "text",
          "code": "Action: Re-scan DOM for input fields\nDiscovered:\n  - \"Contact Person No\" (text input)\n  - \"Contact Person Name\" (text input)\n  - \"Tenament No\" (text input)\n\nAnalysis: These fields were below the fold or loaded dynamically",
          "description": "**[FormDiscoveryAgent]** Wait, I see more fields in the screenshot that I didn't capture...",
          "context": " Fields\n\n**[FormDiscoveryAgent]** Wait, I see more fields in the screenshot that I didn't capture..."
        },
        {
          "language": "text",
          "code": "Injected monitor code:\n  - Tracking XHR requests\n  - Monitoring form events\n  - Capturing validation functions\n\nAction: Fill form and submit\n\nCaptured:\n  1. Form onsubmit() validates fields client-side\n  2. If validation passes, makes POST request to:\n     /Portal/Ajax/RegisterComplaint\n  3. Response contains: {\"success\": true, \"complaintId\": \"RMC123456\"}\n  4. Page shows tracking ID on success\n\nJavaScript Patterns Detected:\n  - Client-side validation before submit\n  - AJAX submission (not standard form POST)\n  - Dynamic tracking ID display",
          "description": "**[JSAnalyzer]** Analyzing form submission logic...",
          "context": "ields\n\n---\n\n### Attempt #5: JavaScript Analysis\n\n**[JSAnalyzer]** Analyzing form submission logic..."
        },
        {
          "language": "text",
          "code": "\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Training Session: Smart Ranchi Complaint Form            \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                           \u2502\n\u2502 Agent's Understanding:                                    \u2502\n\u2502                                                           \u2502\n\u2502 Required Fields:                                          \u2502\n\u2502   \u2713 Select Type (dropdown)                              \u2502\n\u2502   \u2713 Problem (dropdown, depends on Type)                 \u2502\n\u2502   \u2713 Mobile No (text, validation: 10 digits)             \u2502\n\u2502                                                           \u2502\n\u2502 Optional Fields:                                          \u2502\n\u2502   \u25cb Email ID                                             \u2502\n\u2502   \u25cb Residential Address                                  \u2502\n\u2502   \u25cb Remarks                                              \u2502\n\u2502   \u25cb Contact Person No                                    \u2502\n\u2502   \u25cb Contact Person Name                                  \u2502\n\u2502   \u25cb Tenament No                                          \u2502\n\u2502   \u25cb File Upload (with Select File Type dropdown)        \u2502\n\u2502                                                           \u2502\n\u2502 Submission Method: AJAX POST to /Portal/Ajax/...        \u2502\n\u2502                                                           \u2502\n\u2502 [Human Review]                                            \u2502\n\u2502 Does this look correct? [Yes] [No, I'll fix it]         \u2502\n\u2502                                                           \u2502\n\u2502 Any fields missing? [Add Field]                          \u2502\n\u2502 Any fields wrong? [Edit Field]                           \u2502\n\u2502                                                           \u2502\n\u2502 Special instructions:                                     \u2502\n\u2502 [ Optional text box for human hints ]                    \u2502\n\u2502                                                           \u2502\n\u2502 [Looks Good - Generate Scraper] [Agent Retry]           \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518",
          "description": "**Flask Dashboard Display:**",
          "context": "Human Review\n\n**[TrainingUI]** \ud83d\ude4b Showing discovered schema to human...\n\n**Flask Dashboard Display:**"
        }
      ],
      "patterns": [
        {
          "type": "example",
          "pattern": "Smart Ranchi Form"
        }
      ],
      "best_practices": [],
      "architecture_notes": []
    },
    {
      "title": "Start API server",
      "file_path": "PHASES_9_11_COMPLETE.md",
      "key_concepts": [
        "\ud83c\udf89 ALL PHASES COMPLETE - System Status Report",
        "Phases 9 & 11 - Implementation Complete",
        "Phase 9: Multi-Tenant & API Layer \u2705",
        "1. FastAPI REST API Server (`api/fastapi_server.py` - 500 lines)",
        "Start API server",
        "Server runs on http://localhost:8000",
        "Generate API key",
        "Use API",
        "Response",
        "2. API Authentication (`api/authentication.py` - 200 lines)",
        "Generate API key",
        "Output: grv_Xy7k9...3mP2q (save this!)",
        "List all keys",
        "Revoke key",
        "3. Webhook System (`api/webhooks.py` - 300 lines)",
        "Verify HMAC signature",
        "4. Rate Limiter (`api/rate_limiter.py` - 200 lines)",
        "Phase 11: Intelligence Upgrades \u2705",
        "1. Form Clustering (`intelligence/form_clustering.py` - 350 lines)",
        "Cluster forms",
        "Get training order",
        "Output:",
        "[",
        "{\"municipality\": \"ranchi\", \"priority\": 2, \"role\": \"representative\"},",
        "{\"municipality\": \"patna\", \"priority\": 1, \"role\": \"similar\", \"representative\": \"ranchi\"},",
        "...",
        "]",
        "Output:",
        "2. Smart Recommender (`intelligence/smart_recommender.py` - 350 lines)",
        "Example output:",
        "Output:",
        "Complete System Architecture - Final",
        "Complete Feature Matrix",
        "Cost & Time Analysis - Final",
        "Single Municipality",
        "Batch of 50 Municipalities",
        "Annual Costs (500 municipalities)",
        "How to Use - Complete Guide",
        "1. Start API Server",
        "Generate API key first",
        "Save the key: grv_Xy7k9...3mP2q",
        "Start API server",
        "Server runs on http://localhost:8000",
        "API docs available at:",
        "http://localhost:8000/docs (Swagger)",
        "http://localhost:8000/redoc (ReDoc)",
        "2. Train Single Municipality via API",
        "Check status",
        "3. Get Smart Recommendations",
        "For new form",
        "For batch",
        "4. Batch Train with Clustering",
        "5. Subscribe to Webhooks",
        "6. Submit Grievance via API",
        "Production Deployment Checklist",
        "Infrastructure",
        "Security",
        "Monitoring",
        "Testing",
        "Final Metrics",
        "Summary"
      ],
      "code_examples": [
        {
          "language": "bash",
          "code": "# Start API server\npython api/fastapi_server.py\n# Server runs on http://localhost:8000\n\n# Generate API key\npython api/authentication.py generate \"your@email.com\" 100\n\n# Use API\ncurl -X POST http://localhost:8000/api/v1/train \\\n  -H \"X-API-Key: grv_YOUR_API_KEY\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"municipality\": \"bangalore\",\n    \"url\": \"https://bangalore.gov.in/grievance\",\n    \"webhook_url\": \"https://your-app.com/webhook\"\n  }'\n\n# Response\n{\n  \"session_id\": \"bangalore_20241224_103000\",\n  \"municipality\": \"bangalore\",\n  \"status\": \"started\",\n  \"message\": \"Training started for bangalore. Use session_id to check status.\"\n}",
          "description": "**Usage Example**:",
          "context": "o webhooks | 100/hour |\n| `/api/v1/webhooks` | GET | List webhooks | 1000/hour |\n\n**Usage Example**:"
        },
        {
          "language": "bash",
          "code": "# Generate API key\npython api/authentication.py generate \"admin@example.com\" 100\n# Output: grv_Xy7k9...3mP2q (save this!)\n\n# List all keys\npython api/authentication.py list\n\n# Revoke key\npython api/authentication.py revoke grv_Xy7k9...3mP2q",
          "description": "**CLI Usage**:",
          "context": " rate limits\n- SHA256 hashing for security\n- Last used tracking\n- Revocation support\n\n**CLI Usage**:"
        },
        {
          "language": "json",
          "code": "{\n  \"event\": \"training_complete\",\n  \"data\": {\n    \"municipality\": \"bangalore\",\n    \"scraper_path\": \"generated_scrapers/bangalore/bangalore_scraper.py\",\n    \"total_cost\": 0.82,\n    \"success\": true\n  },\n  \"timestamp\": \"2024-12-24T10:30:00\"\n}",
          "description": "**Webhook Payload**:",
          "context": "\n- Automatic retries (3x with exponential backoff)\n- Delivery history tracking\n\n**Webhook Payload**:"
        },
        {
          "language": "python",
          "code": "# Verify HMAC signature\nimport hmac, hashlib\n\nsignature = request.headers['X-Webhook-Signature']\nexpected = hmac.new(\n    secret.encode(),\n    payload.encode(),\n    hashlib.sha256\n).hexdigest()\n\nif f\"sha256={expected}\" != signature:\n    raise ValueError(\"Invalid signature\")",
          "description": "**Webhook Security**:",
          "context": "t\": 0.82,\n    \"success\": true\n  },\n  \"timestamp\": \"2024-12-24T10:30:00\"\n}\n```\n\n**Webhook Security**:"
        },
        {
          "language": "python",
          "code": "[\n    total_fields,\n    required_fields,\n    text_inputs,\n    email_inputs,\n    phone_inputs,\n    number_inputs,\n    dropdowns,\n    text_areas,\n    file_uploads,\n    radio_buttons,\n    checkboxes,\n    date_inputs,\n    has_captcha,\n    multi_step,\n    cascading_fields\n]",
          "description": "**Features Vector** (15 features):",
          "context": "calculation\n- Hierarchical clustering\n- Representative selection\n\n**Features Vector** (15 features):"
        },
        {
          "language": "python",
          "code": "from intelligence.form_clustering import FormClusterer\n\nclusterer = FormClusterer()\n\nforms = {\n    \"ranchi\": form_schema_1,\n    \"patna\": form_schema_2,\n    \"mumbai\": form_schema_3,\n    # ... 50+ forms\n}\n\n# Cluster forms\nclusters = clusterer.cluster_forms(forms, similarity_threshold=0.75)\n\n# Get training order\ntraining_order = clusterer.suggest_training_order(forms)\n\n# Output:\n# [\n#   {\"municipality\": \"ranchi\", \"priority\": 2, \"role\": \"representative\"},\n#   {\"municipality\": \"patna\", \"priority\": 1, \"role\": \"similar\", \"representative\": \"ranchi\"},\n#   ...\n# ]",
          "description": "**Usage**:",
          "context": " 75%)\n4. Repeat until no similar clusters\n5. Select representative (closest to centroid)\n\n**Usage**:"
        },
        {
          "language": "python",
          "code": "insights = clusterer.get_cluster_insights()\n\n# Output:\n{\n  \"total_clusters\": 3,\n  \"clusters\": [\n    {\n      \"cluster_id\": 0,\n      \"size\": 15,\n      \"municipalities\": [\"ranchi\", \"patna\", \"gaya\", ...],\n      \"representative\": \"ranchi\",\n      \"similarity_score\": \"87.3%\",\n      \"recommendation\": \"High priority cluster (15 forms, 87% similar). Train representative first...\"\n    }\n  ],\n  \"recommendations\": [\n    \"Found 1 large cluster (\u22655 forms). Train representatives first to maximize pattern reuse.\",\n    \"Estimated time savings: 52%\"\n  ]\n}",
          "description": "**Insights**:",
          "context": "atna\", \"priority\": 1, \"role\": \"similar\", \"representative\": \"ranchi\"},\n#   ...\n# ]\n```\n\n**Insights**:"
        },
        {
          "language": "text",
          "code": "\ud83c\udfaf HIGH PRIORITY: Clone scraper from 'ranchi'\n   Reason: 98% similarity - minimal changes needed\n   Estimated time: 5-10 minutes\n   Estimated cost: $0.10-0.20\n   ```\n\n2. **Modify** (80-95% similarity):\n   ```\n   \u2705 MEDIUM PRIORITY: Use 'ranchi' as template and modify\n   Reason: 87% similarity - some customization needed\n   Modifications needed:\n     - Add CAPTCHA handling\n     - Add file upload support\n   Estimated time: 10-15 minutes\n   Estimated cost: $0.30-0.50\n   ```\n\n3. **Train with Hints** (60-80% similarity):\n   ```\n   \ud83d\udccb MEDIUM PRIORITY: Train from scratch using patterns from 'ranchi'\n   Reason: 72% similarity - use as reference\n   Reusable patterns:\n     - Selector fallback strategy\n     - Error handling patterns\n   Estimated time: 15-20 minutes\n   Estimated cost: $0.50-0.80\n   ```\n\n4. **Train from Scratch** (<60% similarity):\n   ```\n   \ud83c\udd95 LOW PRIORITY: Train from scratch - no similar patterns found\n   Reason: First time seeing this form structure\n   Estimated time: 20-30 minutes\n   Estimated cost: $0.80-1.20\n   ```\n\n**Optimization Recommendations**:",
          "description": "1. **Clone** (95%+ similarity):",
          "context": "imizations\n- Batch processing strategies\n\n**Recommendation Types**:\n\n1. **Clone** (95%+ similarity):"
        },
        {
          "language": "text",
          "code": "**Batch Strategy Recommendations**:",
          "description": "]",
          "context": "waits\",\n        \"Use faster selectors\",\n        \"Remove unnecessary screenshots\"\n      ]\n    }\n  }\n]"
        },
        {
          "language": "text",
          "code": "**Impact**:\n- **Smart decision making**: Know when to clone vs train\n- **Cost transparency**: See estimates before starting\n- **Batch optimization**: Automatically find clusters and optimize order\n- **Proactive maintenance**: Get alerts before scrapers fail\n\n---\n\n## Complete System Architecture - Final",
          "description": "}",
          "context": "in 4 representatives first, then rapidly deploy to similar forms. Estimated time savings: 40-60%.\"\n}"
        },
        {
          "language": "text",
          "code": "---\n\n## Complete Feature Matrix\n\n| Feature | Status | Impact |\n|---------|--------|--------|\n| **Core Training** | \u2705 | AI-powered scraper generation |\n| **Self-Healing** | \u2705 | 70% automatic fix rate |\n| **Pattern Learning** | \u2705 | 60% time reduction after 10 municipalities |\n| **JS Monitoring** | \u2705 | +70% edge case detection |\n| **Health Tracking** | \u2705 | 90% downtime reduction |\n| **AI Caching** | \u2705 | 40% cost savings |\n| **Batch Processing** | \u2705 | 80% time savings (parallel) |\n| **REST API** | \u2705 NEW | External integration |\n| **Webhooks** | \u2705 NEW | Real-time notifications |\n| **Rate Limiting** | \u2705 NEW | Abuse protection |\n| **Form Clustering** | \u2705 NEW | 52% time savings (similar forms) |\n| **Smart Recommender** | \u2705 NEW | Optimize training strategy |\n| **Batch Optimizer** | \u2705 NEW | Automatic clustering & ordering |\n\n---\n\n## Cost & Time Analysis - Final\n\n### Single Municipality\n\n| Scenario | Time | Cost | Notes |\n|----------|------|------|-------|\n| **Train from scratch** | 20 min | $0.80 | No patterns available |\n| **Clone similar (95%+)** | 5 min | $0.20 | 75% savings |\n| **Modify similar (80-95%)** | 12 min | $0.40 | 50% savings |\n| **With AI cache (40% hit)** | 20 min | $0.48 | 40% savings |\n\n### Batch of 50 Municipalities\n\n| Approach | Time | Cost | Notes |\n|----------|------|------|-------|\n| **Sequential (no optimization)** | 16.7 hrs | $40.00 | Baseline |\n| **Parallel (5 concurrent)** | 3.3 hrs | $40.00 | 80% time savings |\n| **With clustering** | 9.1 hrs | $21.76 | 46% cost savings |\n| **Parallel + clustering** | **1.8 hrs** | **$21.76** | **89% time + 46% cost** |\n\n### Annual Costs (500 municipalities)\n\n| Item | Cost | Notes |\n|------|------|-------|\n| AI API calls | $240/year | With caching (was $400) |\n| Health monitoring | $0 | SQLite (free) |\n| Email alerts | $0 | SMTP (free) |\n| Slack alerts | $0 | Webhooks (free) |\n| FastAPI hosting | $5-10/month | DigitalOcean droplet |\n| **Total** | **$300/year** | Including hosting |\n\n---\n\n## How to Use - Complete Guide\n\n### 1. Start API Server",
          "description": "\u2514\u2500\u2500 Form Clustering \u2190 Smart grouping",
          "context": "cessing \u2190 Parallel execution\n\u251c\u2500\u2500 AI Caching \u2190 Cost optimization\n\u2514\u2500\u2500 Form Clustering \u2190 Smart grouping"
        },
        {
          "language": "text",
          "code": "### 2. Train Single Municipality via API",
          "description": "python api/fastapi_server.py",
          "context": " API docs available at:\n# http://localhost:8000/docs (Swagger)\n# http://localhost:8000/redoc (ReDoc)"
        },
        {
          "language": "text",
          "code": "### 3. Get Smart Recommendations",
          "description": "-H \"X-API-Key: grv_YOUR_KEY\"",
          "context": "p://localhost:8000/api/v1/training/status/bangalore_20241224_103000 \\\n  -H \"X-API-Key: grv_YOUR_KEY\""
        },
        {
          "language": "text",
          "code": "### 4. Batch Train with Clustering",
          "description": "print(f\"Savings: {strategy['savings']['cost_saved_percentage']:.0f}%\")",
          "context": "ls']['estimated_cost']:.2f}\")\nprint(f\"Savings: {strategy['savings']['cost_saved_percentage']:.0f}%\")"
        },
        {
          "language": "text",
          "code": "### 5. Subscribe to Webhooks",
          "description": "}'",
          "context": "\"...\"},\n      {\"municipality\": \"city2\", \"url\": \"...\"},\n      ...\n    ],\n    \"max_concurrent\": 5\n  }'"
        },
        {
          "language": "text",
          "code": "### 6. Submit Grievance via API",
          "description": "}'",
          "context": "hook\",\n    \"events\": [\"training_complete\", \"health_alert\"],\n    \"secret\": \"your_webhook_secret\"\n  }'"
        }
      ],
      "patterns": [],
      "best_practices": [],
      "architecture_notes": [
        "Estimated time: 20-30 minutes\n   Estimated cost: $0.80-1.20\n   ```",
        "- [ ] Deploy FastAPI server (DigitalOcean, AWS, etc.)\n- [ ] Configure reverse proxy (Nginx)\n- [ ] Set up SSL certificate (Let's Encrypt)\n- [ ] Configure firewall rules\n- [ ] Set up monitoring (UptimeRobot, Pingdom)"
      ]
    },
    {
      "title": "\ud83c\udf89 Project Status - Grivredr AI Scraper System",
      "file_path": "PROJECT_STATUS.md",
      "key_concepts": [
        "\ud83c\udf89 Project Status - Grivredr AI Scraper System",
        "\u2705 Completed Components (Phase 1 - Core System)",
        "1. Core Agent Framework \u2705 100%",
        "Auto-retries with reflection",
        "2. Form Discovery Agent \u2705 100%",
        "3. Test Validation Agent \u2705 100%",
        "4. JavaScript Analyzer Agent \u2705 100%",
        "5. Code Generator Agent \u2705 100%",
        "6. Orchestrator \u2705 100%",
        "7. CLI Tool \u2705 100%",
        "8. Documentation \u2705 100%",
        "\ud83d\udcca System Statistics",
        "Lines of Code",
        "File Structure",
        "\ud83c\udfaf What Works Right Now",
        "You can do this TODAY:",
        "1. Install dependencies",
        "2. Train on Smart Ranchi form",
        "This will:",
        "\u2705 Explore the form with browser automation",
        "\u2705 Analyze structure with Claude Vision",
        "\u2705 Test all fields",
        "\u2705 Analyze JavaScript",
        "\u2705 Generate production scraper",
        "\u2705 Create test suite",
        "\u2705 Show cost breakdown",
        "Expected Output:",
        "\ud83d\udea7 Not Yet Implemented (Phase 2)",
        "1. Knowledge Base System \u23f3 0%",
        "2. Flask Dashboard \u23f3 0%",
        "3. Full Test Suite \u23f3 0%",
        "\ud83d\udcb0 Cost Model (As Implemented)",
        "Training Cost Breakdown (Per Municipality)",
        "With Retries (if needed)",
        "After Training",
        "\ud83c\udfae How to Use the System",
        "Quick Start",
        "Clone/navigate to project",
        "Install",
        "Train",
        "Use generated scraper",
        "Advanced: Custom Municipality",
        "\ud83d\udc1b Known Limitations",
        "\ud83d\ude80 Next Steps (Priority Order)",
        "Immediate (Can do now)",
        "Short-term (1-2 days)",
        "Medium-term (1 week)",
        "\ud83c\udfc6 What Makes This Special",
        "1. True Agentic Behavior",
        "2. Cost-Efficient by Design",
        "3. Self-Improving System",
        "4. Production-Ready Code",
        "5. Test-Driven Validation",
        "\ud83d\udcc8 Success Metrics",
        "\ud83c\udf93 Technical Highlights",
        "Design Patterns Used",
        "AI Techniques",
        "Engineering Best Practices",
        "\ud83c\udf89 Conclusion"
      ],
      "code_examples": [
        {
          "language": "python",
          "code": "# Auto-retries with reflection\nfor attempt in range(1, max_attempts + 1):\n    result = await self._execute_attempt(task)\n    if success:\n        return result\n    reflection = await self._reflect_on_failure(result)\n    if attempt == max_attempts:\n        await self._request_human_help()",
          "description": "**Key Capabilities**:",
          "context": "rategy planning with Claude between attempts\n- \u2705 Comprehensive error handling\n\n**Key Capabilities**:"
        },
        {
          "language": "text",
          "code": "1. Form Discovery \u2192 2. JS Analysis \u2192 3. Test Validation \u2192 4. Code Generation\n              \u2193 (if fails)                    \u2193 (if < 70%)\n        Human Intervention            Human Review",
          "description": "**Workflow**:",
          "context": "lation\n- \u2705 Training session persistence (JSON)\n- \u2705 Real-time callbacks for UI updates\n\n**Workflow**:"
        },
        {
          "language": "bash",
          "code": "python train_cli.py ranchi_smart\npython train_cli.py patna https://patna.gov.in/complaint",
          "description": "**Usage**:",
          "context": "ode selection\n- \u2705 Progress display\n- \u2705 Cost breakdown report\n- \u2705 Session results summary\n\n**Usage**:"
        },
        {
          "language": "text",
          "code": "grivredr/\n\u251c\u2500\u2500 agents/\n\u2502   \u251c\u2500\u2500 base_agent.py              \u2705 280 lines\n\u2502   \u251c\u2500\u2500 form_discovery_agent.py    \u2705 590 lines\n\u2502   \u251c\u2500\u2500 test_agent.py              \u2705 440 lines\n\u2502   \u251c\u2500\u2500 js_analyzer_agent.py       \u2705 430 lines\n\u2502   \u251c\u2500\u2500 code_generator_agent.py    \u2705 330 lines\n\u2502   \u2514\u2500\u2500 orchestrator.py            \u2705 380 lines\n\u2502\n\u251c\u2500\u2500 config/\n\u2502   \u251c\u2500\u2500 ai_client.py               \u2705 180 lines (updated)\n\u2502   \u2514\u2500\u2500 municipalities.json        \u2705\n\u2502\n\u251c\u2500\u2500 train_cli.py                   \u2705 120 lines\n\u251c\u2500\u2500 requirements.txt               \u2705 Updated\n\u2502\n\u251c\u2500\u2500 generated_scrapers/            \u2705 (runtime)\n\u251c\u2500\u2500 training_sessions/             \u2705 (runtime)\n\u251c\u2500\u2500 dashboard/static/screenshots/  \u2705 (runtime)\n\u2502\n\u2514\u2500\u2500 Documentation/\n    \u251c\u2500\u2500 IMPLEMENTATION_ROADMAP.md  \u2705 450 lines\n    \u251c\u2500\u2500 REDESIGN_PLAN.md           \u2705 380 lines\n    \u251c\u2500\u2500 AGENTIC_EXAMPLE.md         \u2705 150 lines\n    \u2514\u2500\u2500 PROJECT_STATUS.md          \u2705 This file",
          "description": "- **Total Project**: ~3,600 lines",
          "context": "~2,470 lines\n- **Documentation**: ~1,100 lines\n- **Total Project**: ~3,600 lines\n\n### File Structure"
        },
        {
          "language": "bash",
          "code": "# 1. Install dependencies\npip install -r requirements.txt\nplaywright install chromium\n\n# 2. Train on Smart Ranchi form\npython train_cli.py ranchi_smart\n\n# This will:\n# \u2705 Explore the form with browser automation\n# \u2705 Analyze structure with Claude Vision\n# \u2705 Test all fields\n# \u2705 Analyze JavaScript\n# \u2705 Generate production scraper\n# \u2705 Create test suite\n# \u2705 Show cost breakdown",
          "description": "---",
          "context": "OJECT_STATUS.md          \u2705 This file\n```\n\n---\n\n## \ud83c\udfaf What Works Right Now\n\n### You can do this TODAY:"
        },
        {
          "language": "bash",
          "code": "# Clone/navigate to project\ncd grivredr\n\n# Install\npip install -r requirements.txt\nplaywright install chromium\n\n# Train\npython train_cli.py ranchi_smart\n\n# Use generated scraper\npython -c \"\nimport asyncio\nfrom generated_scrapers.ranchi_smart.ranchi_smart_scraper import RanchiSmartScraper\n\nasync def test():\n    scraper = RanchiSmartScraper(headless=True)\n    result = await scraper.submit_grievance({\n        'mobile': '9876543210',\n        'select_type': 'Electrical',\n        'problem': 'Street light not working',\n        # ... more fields\n    })\n    print(result)\n\nasyncio.run(test())\n\"",
          "description": "---",
          "context": ": $0.00 (no AI calls)\n- **ROI**: Immediate savings\n\n---\n\n## \ud83c\udfae How to Use the System\n\n### Quick Start"
        },
        {
          "language": "bash",
          "code": "python train_cli.py my_city https://mycity.gov.in/complaints",
          "description": "```",
          "context": ". more fields\n    })\n    print(result)\n\nasyncio.run(test())\n\"\n```\n\n### Advanced: Custom Municipality"
        }
      ],
      "patterns": [],
      "best_practices": [],
      "architecture_notes": [
        "2. \u2705 `REDESIGN_PLAN.md` (380 lines) - Design decisions\n3. \u2705 `AGENTIC_EXAMPLE.md` (150 lines) - Training walkthrough\n4. \u2705 `PROJECT_STATUS.md` (This file)",
        "```\ngrivredr/\n\u251c\u2500\u2500 agents/\n\u2502   \u251c\u2500\u2500 base_agent.py              \u2705 280 lines\n\u2502   \u251c\u2500\u2500 form_discovery_agent.py    \u2705 590 lines\n\u2502   \u251c\u2500\u2500 test_agent.py              \u2705 440 lines\n\u2502   \u251c\u2500\u2500 js_analyzer_agent.py       \u2705 430 lines\n\u2502   \u251c\u2500\u2500 code_generator_agent.py    \u2705 330 lines\n\u2502   \u2514\u2500\u2500 orchestrator.py            \u2705 380 lines\n\u2502",
        "\u251c\u2500\u2500 REDESIGN_PLAN.md           \u2705 380 lines\n    \u251c\u2500\u2500 AGENTIC_EXAMPLE.md         \u2705 150 lines\n    \u2514\u2500\u2500 PROJECT_STATUS.md          \u2705 This file\n```",
        "# \u2705 Test all fields\n# \u2705 Analyze JavaScript\n# \u2705 Generate production scraper\n# \u2705 Create test suite\n# \u2705 Show cost breakdown\n```",
        "- AI only during training (one-time)\n- Generated scrapers run without AI ($0)\n- 98%+ cheaper than Skyvern/Multion at scale",
        "1. **Strategy Pattern**: Agents try different strategies on failure\n2. **Observer Pattern**: Callbacks for UI updates\n3. **Template Method**: BaseAgent defines workflow, subclasses implement\n4. **Factory Pattern**: Orchestrator creates and manages agents\n5. **Chain of Responsibility**: Phase 1 \u2192 2 \u2192 3 \u2192 4 with failure handlers"
      ]
    },
    {
      "title": "\ud83c\udf89 Grivredr AI Scraper System - Complete!",
      "file_path": "PROJECT_SUMMARY.md",
      "key_concepts": [
        "\ud83c\udf89 Grivredr AI Scraper System - Complete!",
        "\u2705 What We Built",
        "\ud83d\udcca Cost Model",
        "\ud83c\udfaf Key Innovation",
        "\ud83d\udcc1 Files Created",
        "Core System",
        "Configuration",
        "Scripts",
        "Documentation",
        "\ud83d\ude80 Quick Start",
        "Option 1: Automated",
        "Option 2: Manual",
        "1. Test AI connection",
        "2. Learn Ranchi websites (generates scrapers)",
        "3. Test scrapers",
        "4. Start API",
        "\ud83c\udf10 Target Websites (Ranchi)",
        "\ud83d\udce1 API Endpoints",
        "Learn new municipality",
        "Submit grievance",
        "Check status",
        "List scrapers",
        "Interactive docs",
        "\ud83d\udca1 Usage Example",
        "\ud83c\udfa8 What Makes This Special",
        "1. **Self-Learning**",
        "2. **Cost-Efficient**",
        "3. **Resilient**",
        "4. **Production-Ready**",
        "\ud83d\udd04 How It Works",
        "\ud83d\udee0\ufe0f Tech Stack",
        "\ud83d\udcc8 Scalability",
        "Current Setup",
        "Production Scaling",
        "Multiple workers",
        "Browser pool",
        "Database",
        "\ud83d\udd12 Security",
        "\ud83d\udc1b Debugging",
        "View learning results",
        "Check generated code",
        "View execution logs",
        "Screenshots",
        "\ud83c\udfaf Next Steps",
        "Immediate",
        "Near-term Enhancements",
        "Long-term",
        "\ud83d\udcda Documentation",
        "\ud83e\udd1d Integration Ideas",
        "With Your Main App",
        "In your main FastAPI app",
        "WhatsApp Bot",
        "\ud83d\udcb0 Cost Analysis",
        "Learning Phase (One-time)",
        "Execution Phase (Repeated)",
        "Real-world Example",
        "\ud83c\udf8a Success Metrics",
        "\ud83d\udea7 Known Limitations",
        "\ud83c\udfc6 Competitive Advantages",
        "\ud83c\udf93 Learning Resources",
        "\ud83d\udcde Support",
        "\ud83c\udf89 Conclusion"
      ],
      "code_examples": [
        {
          "language": "text",
          "code": "Skyvern: $0.10 per execution \u00d7 1000 = $100\nGrivredr: $0.12 (one-time) + $0 \u00d7 1000 = $0.12",
          "description": "**Unlike Skyvern/Multion:** We generate code once, then run it repeatedly without AI costs!",
          "context": "ovation\n\n**Unlike Skyvern/Multion:** We generate code once, then run it repeatedly without AI costs!"
        },
        {
          "language": "bash",
          "code": "./quickstart.sh",
          "description": "- `PROJECT_SUMMARY.md` - This file!",
          "context": "- Technical deep-dive\n- `PROJECT_SUMMARY.md` - This file!\n\n## \ud83d\ude80 Quick Start\n\n### Option 1: Automated"
        },
        {
          "language": "bash",
          "code": "# 1. Test AI connection\npython3 test_ai_client.py\n\n# 2. Learn Ranchi websites (generates scrapers)\npython3 learn_ranchi.py\n\n# 3. Test scrapers\npython3 test_scrapers.py\n\n# 4. Start API\npython3 main.py",
          "description": "```",
          "context": "s file!\n\n## \ud83d\ude80 Quick Start\n\n### Option 1: Automated\n```bash\n./quickstart.sh\n```\n\n### Option 2: Manual"
        },
        {
          "language": "bash",
          "code": "# Learn new municipality\nPOST /api/learn\n\n# Submit grievance\nPOST /api/submit\n\n# Check status\nPOST /api/status\n\n# List scrapers\nGET /api/scrapers\n\n# Interactive docs\nhttp://localhost:8000/docs",
          "description": "3. https://jharkhandegovernance.com/grievance/main",
          "context": "intRegistration.aspx?m=Online\n3. https://jharkhandegovernance.com/grievance/main\n\n## \ud83d\udce1 API Endpoints"
        },
        {
          "language": "python",
          "code": "import asyncio\nfrom executor.runner import ScraperExecutor\n\nasync def submit_grievance():\n    executor = ScraperExecutor()\n    \n    result = await executor.execute_scraper(\n        municipality_name=\"ranchi\",\n        website_type=\"complaint_form\",\n        grievance_data={\n            \"name\": \"Rahul Kumar\",\n            \"phone\": \"9876543210\",\n            \"complaint\": \"Street light not working\",\n            \"category\": \"Electricity\",\n            \"address\": \"Sector 5, Ranchi\"\n        }\n    )\n    \n    print(f\"Tracking ID: {result['tracking_id']}\")\n\nasyncio.run(submit_grievance())",
          "description": "```",
          "context": "st scrapers\nGET /api/scrapers\n\n# Interactive docs\nhttp://localhost:8000/docs\n```\n\n## \ud83d\udca1 Usage Example"
        },
        {
          "language": "text",
          "code": "Step 1: Learning (One-time)\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Python learn_ranchi.py              \u2502\n\u2502   \u2193                                 \u2502\n\u2502 Playwright opens browser            \u2502\n\u2502   \u2193                                 \u2502\n\u2502 Navigate to grievance form          \u2502\n\u2502   \u2193                                 \u2502\n\u2502 Take screenshot + extract HTML      \u2502\n\u2502   \u2193                                 \u2502\n\u2502 Claude Vision analyzes structure    \u2502\n\u2502   \u2193                                 \u2502\n\u2502 Claude Opus generates Python code   \u2502\n\u2502   \u2193                                 \u2502\n\u2502 Save: generated_scrapers/ranchi/... \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\nStep 2: Execution (Repeated, Fast)\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 POST /api/submit                    \u2502\n\u2502   \u2193                                 \u2502\n\u2502 Load generated scraper (no AI!)     \u2502\n\u2502   \u2193                                 \u2502\n\u2502 Fill form with user data            \u2502\n\u2502   \u2193                                 \u2502\n\u2502 Submit and capture tracking ID      \u2502\n\u2502   \u2193                                 \u2502\n\u2502 Return result in 5-10 seconds       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518",
          "description": "- Result logging",
          "context": "eady**\n   - FastAPI backend\n   - REST API\n   - Error handling\n   - Result logging\n\n## \ud83d\udd04 How It Works"
        },
        {
          "language": "python",
          "code": "# Multiple workers\nuvicorn main:app --workers 4\n\n# Browser pool\nplaywright_pool = BrowserPool(size=10)\n\n# Database\nPostgreSQL for submissions\nRedis for caching",
          "description": "- Perfect for testing",
          "context": "Current Setup\n- Single server\n- 1 submission at a time\n- Perfect for testing\n\n### Production Scaling"
        },
        {
          "language": "bash",
          "code": "cat website_learner/results_ranchi.json",
          "description": "- \ud83d\udcdd TODO: Rate limiting for production",
          "context": "credential storage\n- \ud83d\udcdd TODO: Rate limiting for production\n\n## \ud83d\udc1b Debugging\n\n### View learning results"
        },
        {
          "language": "bash",
          "code": "cat generated_scrapers/ranchi/ranchi_complaint_form_scraper.py",
          "description": "```",
          "context": " View learning results\n```bash\ncat website_learner/results_ranchi.json\n```\n\n### Check generated code"
        },
        {
          "language": "bash",
          "code": "ls -lt executor/results/",
          "description": "```",
          "context": "\n```bash\ncat generated_scrapers/ranchi/ranchi_complaint_form_scraper.py\n```\n\n### View execution logs"
        },
        {
          "language": "python",
          "code": "# In your main FastAPI app\nfrom executor.runner import ScraperExecutor\n\n@app.post(\"/grievances/submit\")\nasync def submit_via_automation(data: GrievanceData):\n    executor = ScraperExecutor()\n    result = await executor.execute_scraper(\n        municipality_name=data.municipality,\n        website_type=\"complaint_form\",\n        grievance_data=data.dict()\n    )\n    return result",
          "description": "- **ARCHITECTURE.md** - Technical architecture, data flow, deployment",
          "context": "md** - Technical architecture, data flow, deployment\n\n## \ud83e\udd1d Integration Ideas\n\n### With Your Main App"
        },
        {
          "language": "python",
          "code": "from twilio.rest import Client\n\n@app.post(\"/webhook/whatsapp\")\nasync def handle_whatsapp(message: str, from_number: str):\n    # Parse message\n    grievance = parse_complaint(message)\n    \n    # Submit\n    result = await submit_grievance(grievance)\n    \n    # Reply\n    send_whatsapp(\n        to=from_number,\n        text=f\"\u2705 Submitted! Tracking: {result['tracking_id']}\"\n    )",
          "description": "```",
          "context": "e=\"complaint_form\",\n        grievance_data=data.dict()\n    )\n    return result\n```\n\n### WhatsApp Bot"
        },
        {
          "language": "text",
          "code": "Scenario: 5 municipalities, 2 portals each = 10 websites\n\nLearning: 10 \u00d7 $0.12 = $1.20 (one-time)\n\nDaily submissions: 100 grievances \u00d7 $0.00 = $0.00\nMonthly submissions: 3,000 grievances \u00d7 $0.00 = $0.00\nYearly submissions: 36,000 grievances \u00d7 $0.00 = $0.00\n\nTotal Year 1: $1.20",
          "description": "| **Total per submission** | | **$0.00** |",
          "context": "$0.00 |\n| Submit | None | $0.00 |\n| **Total per submission** | | **$0.00** |\n\n### Real-world Example"
        }
      ],
      "patterns": [
        {
          "type": "example",
          "pattern": "** Learn 10 websites ($1.20) \u2192 Submit 1000x grievances ($0.00)"
        }
      ],
      "best_practices": [],
      "architecture_notes": [
        "\u2502   \u2193                                 \u2502\n\u2502 Claude Opus generates Python code   \u2502\n\u2502   \u2193                                 \u2502\n\u2502 Save: generated_scrapers/ranchi/... \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518"
      ]
    },
    {
      "title": "Grivredr Redesign - Agentic Architecture",
      "file_path": "REDESIGN_PLAN.md",
      "key_concepts": [
        "Grivredr Redesign - Agentic Architecture",
        "\ud83c\udfaf Core Problem with Current Approach",
        "\ud83e\udd16 New Approach: True Agentic System",
        "Design Principles",
        "\ud83c\udfd7\ufe0f System Architecture",
        "\ud83d\udccb Detailed Component Design",
        "1. Form Discovery Agent (Agentic)",
        "2. Test-Driven Validation Agent",
        "3. Human-in-the-Loop Training",
        "4. JavaScript Analyzer Agent",
        "5. Cost Tracker",
        "6. Flask Dashboard",
        "\ud83d\udd04 Training Flow Example",
        "\ud83e\uddea Test-Driven Development",
        "Test Hierarchy",
        "Testing Strategy",
        "TDD Example",
        "\ud83d\udcb0 Cost Estimation",
        "Training Phase (Per Municipality)",
        "With Human Training (First Time)",
        "Subsequent Similar Forms",
        "Execution (After Training)",
        "\ud83c\udfaf Success Metrics",
        "\ud83d\udcc5 Implementation Plan",
        "Phase 1: Foundation (Week 1)",
        "Phase 2: Agentic Intelligence (Week 2)",
        "Phase 3: Training & Validation (Week 3)",
        "Phase 4: Production (Week 4)",
        "\ud83d\udd27 Technology Choices",
        "Why These?",
        "\ud83c\udf93 Learning from Screenshot"
      ],
      "code_examples": [
        {
          "language": "text",
          "code": "\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    FLASK DASHBOARD                               \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510       \u2502\n\u2502  \u2502 Training \u2502  \u2502 Monitor  \u2502  \u2502  Cost    \u2502  \u2502 Scraper  \u2502       \u2502\n\u2502  \u2502 Sessions \u2502  \u2502 Agents   \u2502  \u2502 Tracking \u2502  \u2502 Library  \u2502       \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                            \u2502\n                            \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502               ORCHESTRATOR (Main Agent)                          \u2502\n\u2502  \u2022 Spawns specialized sub-agents                                 \u2502\n\u2502  \u2022 Coordinates training sessions                                 \u2502\n\u2502  \u2022 Manages feedback loops                                        \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2518\n                            \u2502\n        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n        \u25bc                   \u25bc                   \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 FORM AGENT   \u2502    \u2502 TEST AGENT   \u2502    \u2502 JS ANALYZER  \u2502\n\u2502              \u2502    \u2502              \u2502    \u2502              \u2502\n\u2502 \u2022 Crawl form \u2502    \u2502 \u2022 Try submit \u2502    \u2502 \u2022 Analyze JS \u2502\n\u2502 \u2022 Discover   \u2502    \u2502 \u2022 Catch errs \u2502    \u2502 \u2022 Find AJAX  \u2502\n\u2502 \u2022 Map fields \u2502    \u2502 \u2022 Validate   \u2502    \u2502 \u2022 Track state\u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502                   \u2502                   \u2502\n       \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                           \u25bc\n                \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                \u2502  REFLECTION LOOP    \u2502\n                \u2502  \u2022 What worked?     \u2502\n                \u2502  \u2022 What failed?     \u2502\n                \u2502  \u2022 Try new approach \u2502\n                \u2502  \u2022 Ask human?       \u2502\n                \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                          \u2502\n                          \u25bc\n                \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                \u2502 KNOWLEDGE BASE      \u2502\n                \u2502 \u2022 Field patterns    \u2502\n                \u2502 \u2022 Validation rules  \u2502\n                \u2502 \u2022 JS patterns       \u2502\n                \u2502 \u2022 Success strategies\u2502\n                \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518",
          "description": "5. **Knowledge Building** - Accumulates learned patterns",
          "context": " adapts strategy\n5. **Knowledge Building** - Accumulates learned patterns\n\n## \ud83c\udfd7\ufe0f System Architecture"
        },
        {
          "language": "python",
          "code": "class FormDiscoveryAgent:\n    async def explore_form(self, url):\n        # Phase 1: Static analysis\n        static_fields = await self.analyze_static_html()\n\n        # Phase 2: Dynamic interaction\n        for field in static_fields:\n            await self.trigger_events(field)  # Populate dropdowns\n            await self.observe_changes()\n\n        # Phase 3: Validation discovery\n        validation_errors = await self.submit_empty_form()\n\n        # Phase 4: JavaScript analysis\n        js_logic = await self.analyze_form_scripts()\n\n        # Phase 5: Reflection\n        if not self.is_complete():\n            await self.ask_claude_for_strategy()\n            return await self.explore_form(url)  # Retry with new strategy\n\n        return FormSchema(fields, validation, js_logic)",
          "description": "**Workflow:**",
          "context": "gger events to populate options\n- **Multi-step detection** - identify wizard patterns\n\n**Workflow:**"
        },
        {
          "language": "python",
          "code": "class ValidationAgent:\n    async def validate_form_schema(self, schema):\n        test_results = []\n\n        # Test 1: Required fields\n        result = await self.test_with_missing_required()\n        if result.failed:\n            await self.refine_schema(result.errors)\n\n        # Test 2: Field types\n        result = await self.test_field_types()\n\n        # Test 3: Submission\n        result = await self.test_full_submission()\n\n        # If any test fails, reflect and retry\n        if not all(test_results):\n            strategy = await self.ask_claude_how_to_fix(test_results)\n            return await self.validate_form_schema(updated_schema)\n\n        return SuccessfulSchema(schema)",
          "description": "**Workflow:**",
          "context": "ional\n- Test dropdown selections\n- Test file uploads\n- Verify form submission success\n\n**Workflow:**"
        },
        {
          "language": "python",
          "code": "class TrainingSession:\n    async def train_on_form(self, url):\n        # Agent's attempt\n        discovered = await form_agent.explore_form(url)\n\n        # Show to human via Flask UI\n        human_feedback = await self.request_human_review(discovered)\n\n        if human_feedback.has_corrections:\n            # Learn from corrections\n            patterns = self.extract_patterns(human_feedback)\n            await self.knowledge_base.store(patterns)\n\n            # Retry with learned patterns\n            discovered = await form_agent.explore_form(url, hints=patterns)\n\n        # Test until it works\n        while not await test_agent.validate(discovered):\n            strategy = await self.ask_claude_what_to_try_next()\n            discovered = await form_agent.apply_strategy(strategy)\n\n        # Generate scraper only after validation\n        scraper = await self.generate_validated_scraper(discovered)\n        return scraper",
          "description": "**Workflow:**",
          "context": "n\n- Collect corrections\n- Store correction patterns\n- Apply patterns to similar forms\n\n**Workflow:**"
        },
        {
          "language": "python",
          "code": "class JavaScriptAnalyzer:\n    async def analyze_form_js(self, page):\n        # Inject monitoring code\n        await page.add_script_tag(content=\"\"\"\n            window._formEvents = [];\n            // Monitor all form-related JS\n        \"\"\")\n\n        # Interact with form\n        await self.fill_and_submit()\n\n        # Collect JS execution traces\n        js_events = await page.evaluate(\"window._formEvents\")\n\n        # Ask Claude to understand the logic\n        explanation = await claude.analyze_js_logic(js_events)\n\n        return JSFormLogic(events, explanation)",
          "description": "**Workflow:**",
          "context": "te management\n- Identify dynamic field population\n- Reverse-engineer validation logic\n\n**Workflow:**"
        },
        {
          "language": "text",
          "code": "1. Human: \"Learn smartranchi.in complaint form\"\n   \u2193\n2. Form Agent: Explores form\n   - Finds: name, mobile, email, address, remarks\n   - Finds: Select Type dropdown (empty initially)\n   - Finds: Tenament No, Contact Person fields\n   - Takes screenshot\n   \u2193\n3. Form Agent: \"I found these fields, but dropdown is empty\"\n   \u2193\n4. Form Agent: Clicks dropdown, observes options populate\n   - Discovers: Options loaded via AJAX\n   - Captures: Network request to get options\n   \u2193\n5. Test Agent: Submits test form\n   - Error: \"Mobile number required\"\n   - Error: \"Please select file type\"\n   \u2193\n6. Form Agent: Updates schema with required fields\n   \u2193\n7. Flask UI: Shows agent's understanding to human\n   Human: \"You missed 'Contact Person Name' field\"\n   \u2193\n8. Form Agent: Re-explores, finds missed field\n   Knowledge Base: Stores pattern \"Contact fields often in pairs\"\n   \u2193\n9. Test Agent: Tries submission again\n   - Success! Captures tracking ID\n   \u2193\n10. Generator: Creates scraper code with all learned logic\n    \u2193\n11. Test Agent: Runs scraper 3 times to verify\n    - All successful\n    \u2193\n12. System: Marks scraper as \"validated\" and saves",
          "description": "- **Knowledge Base** - View learned patterns",
          "context": "te** - Run validation tests\n- **Knowledge Base** - View learned patterns\n\n## \ud83d\udd04 Training Flow Example"
        },
        {
          "language": "text",
          "code": "tests/\n\u251c\u2500\u2500 unit/\n\u2502   \u251c\u2500\u2500 test_form_discovery.py\n\u2502   \u251c\u2500\u2500 test_field_detection.py\n\u2502   \u251c\u2500\u2500 test_js_analyzer.py\n\u2502   \u2514\u2500\u2500 test_validation.py\n\u251c\u2500\u2500 integration/\n\u2502   \u251c\u2500\u2500 test_training_flow.py\n\u2502   \u251c\u2500\u2500 test_agent_coordination.py\n\u2502   \u2514\u2500\u2500 test_scraper_generation.py\n\u2514\u2500\u2500 e2e/\n    \u251c\u2500\u2500 test_smart_ranchi.py\n    \u251c\u2500\u2500 test_jharkhand_portal.py\n    \u2514\u2500\u2500 test_rmc_website.py",
          "description": "```",
          "context": "System: Marks scraper as \"validated\" and saves\n```\n\n## \ud83e\uddea Test-Driven Development\n\n### Test Hierarchy"
        },
        {
          "language": "python",
          "code": "# TDD Example\ndef test_discover_required_fields():\n    \"\"\"Agent should find all required fields through validation errors\"\"\"\n    agent = FormDiscoveryAgent()\n\n    # Test: Submit empty form\n    errors = await agent.submit_empty_form(SMART_RANCHI_URL)\n\n    # Assert: Should catch required fields\n    assert \"Mobile number\" in errors\n    assert \"Email\" in errors\n\n    # Agent should update schema\n    schema = agent.schema\n    assert schema.get_field(\"mobile\").required == True\n\ndef test_retry_on_failure():\n    \"\"\"Agent should retry with new strategy if test fails\"\"\"\n    agent = FormDiscoveryAgent()\n\n    with patch.object(agent, 'ask_claude_for_strategy') as mock:\n        mock.return_value = Strategy(\"Try clicking dropdown first\")\n\n        # First attempt fails\n        schema = await agent.explore_form(url)\n\n        # Should have called Claude for strategy\n        assert mock.called\n\n        # Should have retried\n        assert agent.attempt_count > 1",
          "description": "```",
          "context": "art_ranchi.py\n    \u251c\u2500\u2500 test_jharkhand_portal.py\n    \u2514\u2500\u2500 test_rmc_website.py\n```\n\n### Testing Strategy"
        }
      ],
      "patterns": [],
      "best_practices": [],
      "architecture_notes": [
        "- \u274c Dynamic dropdowns populated by JavaScript\n- \u274c Required fields discovered only on validation\n- \u274c Multi-step forms with state management\n- \u274c AJAX submissions and complex form logic\n- \u274c Learning from failures and self-improvement",
        "- [ ] Form discovery agent core\n- [ ] Test agent framework\n- [ ] Flask dashboard skeleton\n- [ ] Cost tracking"
      ]
    }
  ]
}